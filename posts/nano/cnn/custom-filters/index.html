<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Custom CNN Filters." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Custom Filters | In Too Deep</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../../rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/In-Too-Deep/posts/nano/cnn/custom-filters/" rel="canonical"><!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../../site.webmanifest" rel="manifest">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<meta content="Cloistered Monkey" name="author">
<link href="../mnist-multi-layer-perceptron-with-validation/" rel="prev" title="MNIST Multi-Layer Perceptron with Validation" type="text/html">
<link href="../visualizing-convolving/" rel="next" title="Visualizing Convolving" type="text/html">
<meta content="In Too Deep" property="og:site_name">
<meta content="Custom Filters" property="og:title">
<meta content="https://necromuralist.github.io/In-Too-Deep/posts/nano/cnn/custom-filters/" property="og:url">
<meta content="Custom CNN Filters." property="og:description">
<meta content="article" property="og:type">
<meta content="2018-12-02T16:06:32-08:00" property="article:published_time">
<meta content="cnn" property="article:tag">
<meta content="filters" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/In-Too-Deep/"><span id="blog-title">In Too Deep</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../../rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/In-Too-Deep/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Custom Filters</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-12-02T16:06:32-08:00" itemprop="datePublished" title="2018-12-02 16:06">2018-12-02 16:06</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3d17594">Introduction</a></li>
<li><a href="#org931dd1e">Set Up</a></li>
<li><a href="#org272a285">Read in the image</a></li>
<li><a href="#org7a5a806">Convert the image to grayscale</a></li>
<li><a href="#org68f27b4">Create a custom kernel</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org3d17594">
<h2 id="org3d17594">Introduction</h2>
<div class="outline-text-2" id="text-org3d17594">
<p>This is from <a href="https://github.com/udacity/deep-learning-v2-pytorch.git">Udacity's Deep Learning Repository</a> which supports their Deep Learning Nanodegree.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org931dd1e">
<h2 id="org931dd1e">Set Up</h2>
<div class="outline-text-2" id="text-org931dd1e"></div>
<div class="outline-3" id="outline-container-orgfc34ba3">
<h3 id="orgfc34ba3">Imports</h3>
<div class="outline-text-3" id="text-orgfc34ba3"></div>
<div class="outline-4" id="outline-container-org9b307ec">
<h4 id="org9b307ec">From PyPi</h4>
<div class="outline-text-4" id="text-org9b307ec">
<div class="highlight">
<pre><span></span>from dotenv import load_dotenv
import matplotlib.pyplot as pyplot
import matplotlib.image as mpimg
import cv2
import numpy
import seaborn
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org55faaf5">
<h4 id="org55faaf5">This Project</h4>
<div class="outline-text-4" id="text-org55faaf5">
<div class="highlight">
<pre><span></span>from neurotic.tangles.data_paths import DataPathTwo
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org7e801fe">
<h3 id="org7e801fe">Set Up</h3>
<div class="outline-text-3" id="text-org7e801fe">
<div class="highlight">
<pre><span></span>get_ipython().run_line_magic('matplotlib', 'inline')
seaborn.set(style="whitegrid",
            rc={"axes.grid": False,
                "font.family": ["sans-serif"],
                "font.sans-serif": ["Latin Modern Sans", "Lato"],
                "figure.figsize": (14, 12)},
            font_scale=3)
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org272a285">
<h2 id="org272a285">Read in the image</h2>
<div class="outline-text-2" id="text-org272a285">
<div class="highlight">
<pre><span></span>load_dotenv()
path = DataPathTwo("curved_lane.jpg", folder_key="CNN")
print(path.from_folder)
assert path.from_folder.is_file()
</pre></div>
<pre class="example">
/home/hades/datasets/cnn/curved_lane.jpg

</pre>
<div class="highlight">
<pre><span></span>image = mpimg.imread(path.from_folder)

axe_image = pyplot.imshow(image)
</pre></div>
<div class="figure">
<p><img alt="curved_lane.png" src="curved_lane.png"></p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org7a5a806">
<h2 id="org7a5a806">Convert the image to grayscale</h2>
<div class="outline-text-2" id="text-org7a5a806">
<div class="highlight">
<pre><span></span>gray = cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)
axe_image = pyplot.imshow(gray, cmap='gray')
</pre></div>
<div class="figure">
<p><img alt="gray_curved.png" src="gray_curved.png"></p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org68f27b4">
<h2 id="org68f27b4">Create a custom kernel</h2>
<div class="outline-text-2" id="text-org68f27b4">
<p>Below, you've been given one common type of edge detection filter: a Sobel operator.</p>
<p>The Sobel filter is very commonly used in edge detection and in finding patterns in intensity in an image. Applying a Sobel filter to an image is a way of <b>taking (an approximation) of the derivative of the image</b> in the x or y direction, separately. The operators look as follows.</p>
<div class="figure">
<p><img alt="sobel_ops.png" src="sobel_ops.png"></p>
</div>
<p>For a challenge, see if you can put the image through a series of filters: first one that blurs the image (takes an average of pixels), and then one that detects the edges.</p>
<p>3x3 array for edge detection</p>
<div class="highlight">
<pre><span></span>sobel_y = numpy.array([[ -1, -2, -1], 
                       [  0, 0, 0], 
                       [ 1, 2, 1]])
</pre></div>
<div class="highlight">
<pre><span></span>filtered_image = cv2.filter2D(gray, -1, sobel_y)

axe_image = pyplot.imshow(filtered_image, cmap='gray')
</pre></div>
<div class="figure">
<p><img alt="sobel_1.png" src="sobel_1.png"></p>
</div>
</div>
<div class="outline-3" id="outline-container-org3b6849a">
<h3 id="org3b6849a">Prewitt</h3>
<div class="outline-text-3" id="text-org3b6849a">
<p>This matrix is from <a href="https://hipersayanx.blogspot.com/2015/08/convolutional-edge-detection-filters.html">this</a> blog post.</p>
<div class="highlight">
<pre><span></span>prewitt = numpy.array([[-1, -1, -1],
                       [0, 0, 0],
                       [1, 1, 1]])
</pre></div>
<div class="highlight">
<pre><span></span>filtered_prewitt = cv2.filter2D(gray, -1, prewitt)

axe_image = pyplot.imshow(filtered_prewitt, cmap='gray')
</pre></div>
<div class="figure">
<p><img alt="prewitt.png" src="prewitt.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org79fb04c">
<h3 id="org79fb04c">Sharpen</h3>
<div class="outline-text-3" id="text-org79fb04c">
<p>This is from the <a href="https://en.wikipedia.org/wiki/Kernel_(image_processing)">Wikipedia article</a> about kernels for image processing.</p>
<div class="highlight">
<pre><span></span>mask = numpy.array([[0, -1, 0],
                    [-1, 5, -1],
                    [0, -1, 0]])
sharpened = cv2.filter2D(gray, -1, mask)

axe_image = pyplot.imshow(sharpened, cmap='gray')
</pre></div>
<div class="figure">
<p><img alt="sharpen.png" src="sharpen.png"></p>
</div>
<p>This one isn't so obvious, but if you compare it to the original grayscale image you'll see that it is a little less blurry.</p>
</div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../../categories/cnn/" rel="tag">cnn</a></li>
<li><a class="tag p-category" href="../../../../categories/filters/" rel="tag">filters</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../mnist-multi-layer-perceptron-with-validation/" rel="prev" title="MNIST Multi-Layer Perceptron with Validation">Previous post</a></li>
<li class="next"><a href="../visualizing-convolving/" rel="next" title="Visualizing Convolving">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents Â© 2019 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script>
</body>
</html>
