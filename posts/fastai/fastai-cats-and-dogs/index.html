<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="A look at the FastAI Cats and Dogs quick-start example." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>FastAI Cats and Dogs | Neurotic Networking</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/fastai/fastai-cats-and-dogs/" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../../gans/evaluating-gans/" rel="prev" title="Evaluating GANs" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="FastAI Cats and Dogs" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/fastai/fastai-cats-and-dogs/" property="og:url">
<meta content="A look at the FastAI Cats and Dogs quick-start example." property="og:description">
<meta content="article" property="og:type">
<meta content="2022-10-25T17:50:22-07:00" property="article:published_time">
<meta content="fastai" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../../"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">FastAI Cats and Dogs</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2022-10-25T17:50:22-07:00" itemprop="datePublished" title="2022-10-25 17:50">2022-10-25 17:50</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org8408880">Importing</a></li>
<li><a href="#orgf092455">Setting Up</a></li>
<li><a href="#orgba8166a">Train It</a></li>
<li><a href="#org0f5cc6e">Some Test Images</a>
<ul>
<li><a href="#org0e00af7">A Cat</a></li>
<li><a href="#orga4982ca">A Negative Test Image</a></li>
<li><a href="#org34530c0">A Strange Cat</a></li>
</ul>
</li>
<li><a href="#org62ccabc">The End</a></li>
<li><a href="#org12d0249">Sources</a>
<ul>
<li><a href="#orgc850d7c">Fast AI</a></li>
<li><a href="#orgfab7d69">Test Images (Wikimedia commons)</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org8408880">
<h2 id="org8408880">Importing</h2>
<div class="outline-text-2" id="text-org8408880">
<div class="highlight">
<pre><span></span><span class="c1"># python standard library</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</pre></div>
<p>As noted on <a href="https://stackoverflow.com/questions/65128126/fast-ai-attributeerror-learner-object-has-no-attribute-fine-tune">Stack Overflow</a>, FastAI does a lot of monkey patching, so if you just import something from where it's defined (to make it clearer where things are coming from) it might not have the methods or attributes you expect. In this case, for instance, the <code>vision_learner</code> function is defined in <code>fastai.vision.learner</code> but if you try and import it from there the object you get back won't have the <code>to_fp16</code> method that we're going to use so you have to import it from <code>fastai.vision.all</code> instead. Since there's no good way to avoid using <code>all</code> I'll import objects from there but I'll try and also point to the original modules where things are defined to make it easier to look things up.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Module</th>
<th class="org-left" scope="col">Import</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">fastai.data.external</td>
<td class="org-left">untar_data, URLs</td>
</tr>
<tr>
<td class="org-left">fastai.data.transforms</td>
<td class="org-left">get_image_files</td>
</tr>
<tr>
<td class="org-left">fastai.metrics</td>
<td class="org-left">error_rate</td>
</tr>
<tr>
<td class="org-left">fastai.vision.augment</td>
<td class="org-left">Resize</td>
</tr>
<tr>
<td class="org-left">fastai.vision.core</td>
<td class="org-left">PILImage</td>
</tr>
<tr>
<td class="org-left">fastai.vision.data</td>
<td class="org-left">ImageDataLoaders</td>
</tr>
<tr>
<td class="org-left">fastai.vision.learner</td>
<td class="org-left">vision_learner</td>
</tr>
<tr>
<td class="org-left">torchvision.models.resnet</td>
<td class="org-left">resnet34</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ImageDataLoaders</span><span class="p">,</span>
    <span class="n">PILImage</span><span class="p">,</span>
    <span class="n">Resize</span><span class="p">,</span> 
    <span class="n">URLs</span><span class="p">,</span>
    <span class="n">error_rate</span><span class="p">,</span>
    <span class="n">get_image_files</span><span class="p">,</span>
    <span class="n">resnet34</span><span class="p">,</span>
    <span class="n">untar_data</span><span class="p">,</span>
    <span class="n">vision_learner</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf092455">
<h2 id="orgf092455">Setting Up</h2>
<div class="outline-text-2" id="text-orgf092455">
<p>This downloads the <a href="https://www.robots.ox.ac.uk/~vgg/data/pets/">Oxford-IIIT Pet Dataset</a>. Despite the name, there are only cats and dogs in the dataset (37 breeds across the species).</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Function/Object</th>
<th class="org-left" scope="col">Description</th>
<th class="org-left" scope="col">Documentation Link</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>untar_data</code></td>
<td class="org-left">Function to download fastai datasets/weights</td>
<td class="org-left"><a href="https://docs.fast.ai/data.external.html">External Data</a>, <a href="https://docs.fast.ai/data.external.html#untar_data">function arguments</a></td>
</tr>
<tr>
<td class="org-left"><code>URLs</code></td>
<td class="org-left">Constants for datasets</td>
<td class="org-left"><a href="https://docs.fast.ai/data.external.html#urls">A <i>brief</i> description</a></td>
</tr>
</tbody>
</table>
<p>By default this will download the data to <code>~/.fastai/data</code> but both <code>untar_data</code> and <code>URLs</code> (note the <code>s</code> at the end is lowercase) take an argument <code>c_key</code> that allows changing this but I don't know what the difference is between using one or the other.</p>
<div class="highlight">
<pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span><span class="p">)</span><span class="o">/</span><span class="s2">"images"</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
<pre class="example">
/home/athena/.fastai/data/oxford-iiit-pet/images
</pre>
<p>The names of the files give the breed of the pet (either cat or dog) with dog names all in lower case (e.g. "yorkshire_terrire_9.jpg") and cats with the first initials capitalized (e.g. "Abyssinian_100.jpg"). So our function to categorize the training data will check if the first letter is a capital letter and label it True if it is, False if it isn't, using the following function.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">its_a_cat</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""Decide if file is a picture of a cat</span>

<span class="sd">    Args:</span>
<span class="sd">     filename: name of file where first letter is capitalized if it's a cat</span>

<span class="sd">    Returns:</span>
<span class="sd">     True if first letter is capitalized (so it's a picture of a cat)</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">filename</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span>
</pre></div>
<p>This next bit creates a batch data loader for us.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Object</th>
<th class="org-left" scope="col">Description</th>
<th class="org-left" scope="col">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>ImageDataLoaders</code></td>
<td class="org-left">Data loader with functions for images.</td>
<td class="org-left"><a href="https://docs.fast.ai/vision.data.html#imagedataloaders">ImageDataLoaders</a>, <a href="https://docs.fast.ai/vision.data.html#imagedataloaders.from_name_func">from_name_func</a></td>
</tr>
<tr>
<td class="org-left"><code>get_image_files</code></td>
<td class="org-left">Recursively retrieve images from folders.</td>
<td class="org-left"><a href="https://docs.fast.ai/data.transforms.html#get_image_files">docstring</a></td>
</tr>
<tr>
<td class="org-left"><code>Resize</code></td>
<td class="org-left">Resize each image (if you pass in one size it uses it for all dimensions).</td>
<td class="org-left"><a href="https://docs.fast.ai/vision.augment.html#resize">docstring</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="highlight">
<pre><span></span><span class="n">loader</span> <span class="o">=</span> <span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_name_func</span><span class="p">(</span>
    <span class="n">path</span><span class="p">,</span>
    <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
    <span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">label_func</span><span class="o">=</span><span class="n">its_a_cat</span><span class="p">,</span>
    <span class="n">item_tfms</span><span class="o">=</span><span class="n">Resize</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
<p>Now we create the model that learns to detect cats.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Object</th>
<th class="org-left" scope="col">Description</th>
<th class="org-left" scope="col">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>vision_learner</code></td>
<td class="org-left">Builds a model for transfer learning.</td>
<td class="org-left"><a href="https://docs.fast.ai/vision.learner.html#vision_learner">Arguments</a></td>
</tr>
<tr>
<td class="org-left"><code>resnet34</code></td>
<td class="org-left">Residual Network model</td>
<td class="org-left"><a href="https://pytorch.org/vision/main/models/generated/torchvision.models.resnet34.html">torchvision documentation</a></td>
</tr>
<tr>
<td class="org-left"><code>error_rate</code></td>
<td class="org-left">\(1 - accuracy\) (the fraction that was incorrect)</td>
<td class="org-left"><a href="https://docs.fast.ai/metrics.html#error_rate">arguments</a></td>
</tr>
<tr>
<td class="org-left"><code>to_fp16</code></td>
<td class="org-left">Use 16-bit (half-precision) floats</td>
<td class="org-left"><a href="https://docs.fast.ai/callback.fp16.html">Mixed Precision Training Explained</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="highlight">
<pre><span></span><span class="n">learner</span> <span class="o">=</span> <span class="n">vision_learner</span><span class="p">(</span>
    <span class="n">loader</span><span class="p">,</span> <span class="n">resnet34</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">error_rate</span><span class="p">)</span>

<span class="n">cat_model</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>
<p>Pretty much all of this is inexplicable if you haven't used some kind of neural network library before, but that last call (``to_fp16``) seems especially mysterious. This first part is just about making sure things work, though, so I'll wait until I get to the more detailed explanations to figure it out, although their article <a href="https://docs.fast.ai/callback.fp16.html">"Mixed Precision Training Explained"</a> explains it pretty well.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgba8166a">
<h2 id="orgba8166a">Train It</h2>
<div class="outline-text-2" id="text-orgba8166a">
<p>We're using a pre-trained model so we just have to do some transfer learning - freezing the weights of most of the layers and training the last layer to make a cat or not a cat classification.</p>
<p>For some reason fastai assumes that you'll only run it in a jupyter notebook and dumps out a progress bar with no simple way to disable it permanently. As a workaround I'll use the context-manager <code>no_bar</code> to turn off the progress bar temporarily.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Method</th>
<th class="org-left" scope="col">Description</th>
<th class="org-left" scope="col">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>fine_tune</code></td>
<td class="org-left">Does transfer learning (presumably)</td>
<td class="org-left">None found, but here's the signatures for the <a href="https://docs.fast.ai/learner.html#transfer-learning">freeze and unfreeze methods</a></td>
</tr>
<tr>
<td class="org-left"><code>no_bar</code></td>
<td class="org-left">Turn off the progress bar.</td>
<td class="org-left"><a href="https://docs.fast.ai/callback.progress.html#no_bar">docstring</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">cat_model</span><span class="o">.</span><span class="n">no_bar</span><span class="p">():</span>
    <span class="n">cat_model</span><span class="o">.</span><span class="n">fine_tune</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
<pre class="example">
[0, 0.17085878551006317, 0.019044965505599976, 0.005412719678133726, '00:20']
[0, 0.05584857985377312, 0.01942548155784607, 0.0067658997140824795, '00:25']
</pre>
<p>Fastai really seems to want to force you to use their system the way they do - the output from <code>fine_tune</code> is printed to standard out and not returned as some kind of object so I can't re-format it to make it nicer looking here (using org-mode), but for reference, the columns for the two rows of output are:</p>
<ul class="org-ul">
<li>epoch</li>
<li>train_loss</li>
<li>valid_loss</li>
<li>error_rate</li>
<li>time</li>
</ul>
<p>Given these labels, the output of the last block shows that the error rate for the second epoch was 0.005, and it took about twenty and twenty-five seconds per epoch.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org0f5cc6e">
<h2 id="org0f5cc6e">Some Test Images</h2>
<div class="outline-text-2" id="text-org0f5cc6e">
<p>We're going to apply our model to some images of cats and a dog to see what it tells us about the image. Since it's the same process for each image I'll create a function <code>check_image</code> to handle it.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Object</th>
<th class="org-left" scope="col">Description</th>
<th class="org-left" scope="col">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>PILImage</code></td>
<td class="org-left">Object to represent images.</td>
<td class="org-left"><a href="https://docs.fast.ai/vision.core.html#pilimage">docstring</a></td>
</tr>
<tr>
<td class="org-left"><code>create</code></td>
<td class="org-left">Load the image as PILImage</td>
<td class="org-left"><a href="https://docs.fast.ai/vision.core.html#load_image">load_image</a>, <a href="https://docs.fast.ai/vision.core.html#pilimage">PILBase</a> (follow source link to see definition of <code>create</code>)</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">check_image</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Loads the image and checks if it's a cat</span>

<span class="sd">    Args:</span>
<span class="sd">     path: string with path to the image</span>
<span class="sd">    """</span>
    <span class="n">POSITIVE</span><span class="p">,</span> <span class="n">NEGATIVE</span> <span class="o">=</span> <span class="s2">" think"</span><span class="p">,</span> <span class="s2">" don't think"</span>

    <span class="n">image</span> <span class="o">=</span> <span class="n">PILImage</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">())</span>

    <span class="k">with</span> <span class="n">cat_model</span><span class="o">.</span><span class="n">no_bar</span><span class="p">():</span>
        <span class="n">ees_cat</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">probablilities</span> <span class="o">=</span> <span class="n">cat_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"I</span><span class="si">{</span><span class="n">POSITIVE</span> <span class="k">if</span> <span class="n">ees_cat</span><span class="o">==</span><span class="s1">'True'</span> <span class="k">else</span> <span class="n">NEGATIVE</span><span class="si">}</span><span class="s2"> this is a cat."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The probability that it's a cat is </span><span class="si">{</span><span class="n">probablilities</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-org0e00af7">
<h3 id="org0e00af7">A Cat</h3>
<div class="outline-text-3" id="text-org0e00af7">
<p>Here's our first test image.</p>
<div class="figure">
<p><img alt="test-cat.jpg" src="test-cat.jpg"></p>
</div>
<p>As you can see, it appears to be ridden with parasites, causing it to scratch uncontrollably (the toxoplasma isn't visible but assumed) -let's see how our classifier does at guessing that it's a cat.</p>
<div class="highlight">
<pre><span></span><span class="n">check_image</span><span class="p">(</span><span class="s2">"~/test-cat.jpg"</span><span class="p">)</span>
</pre></div>
<pre class="example">
I think this is a cat.
The probability that it's a cat is 1.00
</pre>
<p>So, it's pretty sure that this is a cat.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orga4982ca">
<h3 id="orga4982ca">A Negative Test Image</h3>
<div class="outline-text-3" id="text-orga4982ca">
<p>We could try any image, but for now, since the dataset used dogs and cats, let's see if it thinks a dog is a cat.</p>
<div class="figure">
<p><img alt="test-dog.jpg" src="test-dog.jpg"></p>
</div>
<div class="highlight">
<pre><span></span><span class="n">check_image</span><span class="p">(</span><span class="s2">"~/test-dog.jpg"</span><span class="p">)</span>
</pre></div>
<pre class="example">
I don't think this is a cat.
The probability that it's a cat is 0.00
</pre>
<p>It's sure that this isn't a cat.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org34530c0">
<h3 id="org34530c0">A Strange Cat</h3>
<div class="outline-text-3" id="text-org34530c0">
<p>I tried to find images of cats that looked like dogs or vice-versa, but it turns out that they're pretty different looking things, so let's just try an unusual looking cat.</p>
<div class="figure">
<p><img alt="elf-cat.jpg" src="elf-cat.jpg"></p>
</div>
<div class="highlight">
<pre><span></span><span class="n">check_image</span><span class="p">(</span><span class="s2">"~/elf-cat.jpg"</span><span class="p">)</span>
</pre></div>
<pre class="example">
I think this is a cat.
The probability that it's a cat is 1.00
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org62ccabc">
<h2 id="org62ccabc">The End</h2>
<div class="outline-text-2" id="text-org62ccabc">
<p>So there you go, not really exciting, which I suppose is sort of the point of fastai - it should be simple, almost boring, to do image classification. This is just a rehash of what they did, of course, a better check would be to try something different, but since this is the first take it'll have to do for now.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org12d0249">
<h2 id="org12d0249">Sources</h2>
<div class="outline-text-2" id="text-org12d0249"></div>
<div class="outline-3" id="outline-container-orgc850d7c">
<h3 id="orgc850d7c">Fast AI</h3>
<div class="outline-text-3" id="text-orgc850d7c">
<ul class="org-ul">
<li><a href="https://docs.fast.ai/quick_start.html">The Quickstart</a></li>
</ul>
</div>
</div>
<div class="outline-3" id="outline-container-orgfab7d69">
<h3 id="orgfab7d69">Test Images (Wikimedia commons)</h3>
<div class="outline-text-3" id="text-orgfab7d69">
<ul class="org-ul">
<li><a href="https://commons.wikimedia.org/wiki/File:Golden_Retriever_Hund_Dog.JPG">Golden Retriever</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Cat_scratching.jpg">Cat Scratching</a></li>
<li><a href="https://commons.wikimedia.org/wiki/File:Elf1111111.jpg">Elf Cat</a></li>
</ul>
</div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/fastai/" rel="tag">fastai</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../../gans/evaluating-gans/" rel="prev" title="Evaluating GANs">Previous post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer"><a href="https://creativecommons.org/licenses/by/4.0/" rel="license"><img alt="Creative Commons License" id="license-image" src="https://licensebuttons.net/l/by/4.0/80x15.png" style="border-width:0"></a>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>. <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
