<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Sentiment Analysis using a Deep Neural Network." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Sentiment Analysis: Deep Learning Model | Neurotic Networking</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/sentiment-analysis-deep-learning-model/" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../data-generators/" rel="prev" title="Data Generators" type="text/html">
<link href="../sentiment-analysis-pre-processing-the-data/" rel="next" title="Sentiment Analysis: Pre-processing the Data" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="Sentiment Analysis: Deep Learning Model" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/sentiment-analysis-deep-learning-model/" property="og:url">
<meta content="Sentiment Analysis using a Deep Neural Network." property="og:description">
<meta content="article" property="og:type">
<meta content="2020-12-23T15:14:07-08:00" property="article:published_time">
<meta content="deep learning" property="article:tag">
<meta content="nlp" property="article:tag">
<meta content="sentiment analysis" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../../"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../rss.xml">RSS feed</a></li>
<li class="nav-item"><a class="nav-link" href="https://necromuralist.github.io/">Cloistered Monkey</a></li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Sentiment Analysis: Deep Learning Model</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2020-12-23T15:14:07-08:00" itemprop="datePublished" title="2020-12-23 15:14">2020-12-23 15:14</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org841270e">Beginning</a>
<ul>
<li><a href="#org4c1cb67">Imports</a></li>
<li><a href="#orgdf65373">Set Up</a>
<ul>
<li><a href="#org0fb5c69">The Random Seed</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4f39b62">Middle</a>
<ul>
<li><a href="#org36b6854">Trax Review</a>
<ul>
<li><a href="#orge0dbe4d">JAX Arrays</a></li>
<li><a href="#orgb73edef">Squaring</a></li>
<li><a href="#org68fc974">Gradients</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgac56437">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org841270e">
<h2 id="org841270e">Beginning</h2>
<div class="outline-text-2" id="text-org841270e">
<p>Previously we created sentiment analysis models using the Logistic Regression and Naive Bayes algorithms. However if we were to give those models an example like:</p>
<blockquote>
<p>This movie was almost good.</p>
</blockquote>
<p>The model would have predicted a positive sentiment for that review. That sentence, however, is expressing the negative sentiment that the movie was not good. To solve those kinds of misclassifications we will write a program that uses deep neural networks to identify sentiment in text.</p>
<p>This model will follow a similar structure to the Continuous Bag of Words Model (<a href="../introducing-the-cbow-model/">Introducing the CBOW Model</a>) that we looked at previously - indeed most of the deep nets have a similar structure. The only thing that changes is the model architecture, the inputs, and the outputs. Although we looked at <a href="https://github.com/google/trax">Trax</a> and <a href="https://jax.readthedocs.io/en/latest/index.html">JAX</a> in a previous post (<a href="../introducing-trax/">Introducing Trax</a>) we'll start off with a review of some of their features and then in future posts we'll implement the actual model. These are the other posts.</p>
<ul class="org-ul">
<li><a href="../sentiment-analysis-pre-processing-the-data/">Loading the Data</a></li>
<li><a href="../sentiment-analysis-defining-the-model/">Defining the Model</a></li>
<li><a href="../sentiment-analysis-training-the-model/">Training the Model</a></li>
<li><a href="../sentiment-analysis-testing-the-model/">Testing the Model</a></li>
</ul>
</div>
<div class="outline-3" id="outline-container-org4c1cb67">
<h3 id="org4c1cb67">Imports</h3>
<div class="outline-text-3" id="text-org4c1cb67">
<div class="highlight">
<pre><span></span><span class="c1"># from python</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># from pypi</span>
<span class="kn">from</span> <span class="nn">trax</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">import</span> <span class="nn">trax</span>
<span class="kn">import</span> <span class="nn">trax.fastmath.numpy</span> <span class="k">as</span> <span class="nn">numpy</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgdf65373">
<h3 id="orgdf65373">Set Up</h3>
<div class="outline-text-3" id="text-orgdf65373"></div>
<div class="outline-4" id="outline-container-org0fb5c69">
<h4 id="org0fb5c69">The Random Seed</h4>
<div class="outline-text-4" id="text-org0fb5c69">
<div class="highlight">
<pre><span></span><span class="n">trax</span><span class="o">.</span><span class="n">supervised</span><span class="o">.</span><span class="n">trainer_lib</span><span class="o">.</span><span class="n">init_random_number_generators</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org4f39b62">
<h2 id="org4f39b62">Middle</h2>
<div class="outline-text-2" id="text-org4f39b62"></div>
<div class="outline-3" id="outline-container-org36b6854">
<h3 id="org36b6854">Trax Review</h3>
<div class="outline-text-3" id="text-org36b6854"></div>
<div class="outline-4" id="outline-container-orge0dbe4d">
<h4 id="orge0dbe4d">JAX Arrays</h4>
<div class="outline-text-4" id="text-orge0dbe4d">
<p>First, the JAX reimplementation of numpy (from <a href="https://trax-ml.readthedocs.io/en/latest/trax.fastmath.html">Trax.fastmath</a>).</p>
<div class="highlight">
<pre><span></span><span class="n">an_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">an_array</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">an_array</span><span class="p">))</span>
</pre></div>
<pre class="example">
DeviceArray(5., dtype=float32)
&lt;class 'jax.interpreters.xla._DeviceArray'&gt;
</pre>
<p><b>Note:</b> the trax library is strict about the typing so <code>5</code> won't work, it has to be a float.</p>
</div>
</div>
<div class="outline-4" id="outline-container-orgb73edef">
<h4 id="orgb73edef">Squaring</h4>
<div class="outline-text-4" id="text-orgb73edef">
<p>Now we'll create a function to square the array.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"f(</span><span class="si">{</span><span class="n">an_array</span><span class="si">}</span><span class="s2">) -&gt; </span><span class="si">{</span><span class="n">square</span><span class="p">(</span><span class="n">an_array</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<pre class="example">
f(5.0) -&gt; 25.0
</pre></div>
</div>
<div class="outline-4" id="outline-container-org68fc974">
<h4 id="org68fc974">Gradients</h4>
<div class="outline-text-4" id="text-org68fc974">
<p>The gradient (derivative) of function <code>f</code> with respect to its input <code>x</code> is the derivative of \(x^2\).</p>
<ul class="org-ul">
<li>The derivative of \(x^2\) is \(2x\).</li>
<li>When <i>x</i> is <i>5</i>, then <i>2x=10</i>.</li>
</ul>
<p>You can calculate the gradient of a function by using <code>trax.fastmath.grad(fun=)</code> and passing in the name of the function.</p>
<ul class="org-ul">
<li>In this case the function you want to take the gradient of is <code>square</code>.</li>
<li>The object returned (saved in <code>square_gradient</code> in this example) is a function that can calculate the gradient of <code>square</code> for a given <code>trax.fastmath.numpy</code> array.</li>
</ul>
<p>Use <code>trax.fastmath.grad</code> to calculate the gradient (derivative) of the function.</p>
<div class="highlight">
<pre><span></span><span class="n">square_gradient</span> <span class="o">=</span> <span class="n">trax</span><span class="o">.</span><span class="n">fastmath</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">square</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">square_gradient</span><span class="p">))</span>
</pre></div>
<pre class="example">
&lt;class 'function'&gt;
</pre>
<p>Call the newly created function and pass in a value for x (the DeviceArray stored in 'a')</p>
<div class="highlight">
<pre><span></span><span class="n">gradient_calculation</span> <span class="o">=</span> <span class="n">square_gradient</span><span class="p">(</span><span class="n">an_array</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">gradient_calculation</span><span class="p">)</span>
</pre></div>
<pre class="example">
DeviceArray(10., dtype=float32)
</pre>
<p>The function returned by <code>trax.fastmath.grad</code> takes in <i>x=5</i> and calculates the gradient of <code>square</code>, which is <i>2x</i>, which equals <i>10</i>. The value is also stored as a DeviceArray from the jax library.</p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgac56437">
<h2 id="orgac56437">End</h2>
<div class="outline-text-2" id="text-orgac56437">
<p>Now that we've had a brief review of Trax let's move on to <a href="../sentiment-analysis-pre-processing-the-data/">loading the data</a>.</p>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/deep-learning/" rel="tag">deep learning</a></li>
<li><a class="tag p-category" href="../../../categories/nlp/" rel="tag">nlp</a></li>
<li><a class="tag p-category" href="../../../categories/sentiment-analysis/" rel="tag">sentiment analysis</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../data-generators/" rel="prev" title="Data Generators">Previous post</a></li>
<li class="next"><a href="../sentiment-analysis-pre-processing-the-data/" rel="next" title="Sentiment Analysis: Pre-processing the Data">Next post</a></li>
</ul>
</nav>
</aside>
<script async id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
<script type="text/x-mathjax-config">

        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']],},

        });
</script>
<link href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script>
<script>

    MathJax = {
        tex: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            processEscapes: true,
            processEnvironments: true,
        }
    }
</script>
<link href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"></script></article>
<!--End of body content-->
<footer id="footer"><a href="https://creativecommons.org/licenses/by/4.0/" rel="license"><img alt="Creative Commons License" id="license-image" src="https://licensebuttons.net/l/by/4.0/80x15.png" style="border-width:0"></a>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>. <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
