<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Pre-processing twitter data for our auto-complete system." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Auto-Complete: Pre-Process the Data I | Neurotic Networking</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/auto-complete-pre-process-the-data-i/index.html" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../auto-complete/index.html" rel="prev" title="Auto-Complete" type="text/html">
<link href="../auto-complete-pre-process-the-data-ii/index.html" rel="next" title="Auto-Complete: Pre-Process the Data II" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="Auto-Complete: Pre-Process the Data I" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/auto-complete-pre-process-the-data-i/index.html" property="og:url">
<meta content="Pre-processing twitter data for our auto-complete system." property="og:description">
<meta content="article" property="og:type">
<meta content="2020-12-03T18:24:54-08:00" property="article:published_time">
<meta content="auto-complete" property="article:tag">
<meta content="n-grams" property="article:tag">
<meta content="nlp" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../../"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Monkey Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">The Cloistered Monkey</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach-Pig Rump & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href="#">Auto-Complete: Pre-Process the Data I</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2020-12-03T18:24:54-08:00" itemprop="datePublished" title="2020-12-03 18:24">2020-12-03 18:24</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="index.html#orgbdbc2e3">Beginning</a>
<ul>
<li><a href="index.html#orgf557910">Imports</a></li>
<li><a href="index.html#orgde65f44">Set Up</a>
<ul>
<li><a href="index.html#org759c53d">The Environment</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="index.html#org314fa21">Middle</a>
<ul>
<li><a href="index.html#org0da0a21">Load the Data</a></li>
<li><a href="index.html#orgde0d47f">Split To Sentences</a>
<ul>
<li><a href="index.html#orgb752a79">Test The Code</a></li>
</ul>
</li>
<li><a href="index.html#org5a812bb">Tokenize Sentences</a>
<ul>
<li><a href="index.html#orgf765fa3">Test the Code</a></li>
</ul>
</li>
<li><a href="index.html#orgccb59b4">Combine Split Sentences and Tokenize</a>
<ul>
<li><a href="index.html#org52cae06">Test It</a></li>
</ul>
</li>
<li><a href="index.html#orgf2cf5b4">Split Train and Test Sets</a></li>
<li><a href="index.html#org5faee64">Object-Oriented</a>
<ul>
<li><a href="index.html#org0e7c135">Imports</a></li>
<li><a href="index.html#orgcf3188c">The Tokenizer</a></li>
<li><a href="index.html#org20a2d79">Train-Test-Split</a></li>
<li><a href="index.html#org50bb7ec">Test It Out</a></li>
</ul>
</li>
<li><a href="index.html#orgaceb390">Training And Test Sets</a></li>
</ul>
</li>
<li><a href="index.html#org4623761">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgbdbc2e3">
<h2 id="orgbdbc2e3">Beginning</h2>
<div class="outline-text-2" id="text-orgbdbc2e3">
<p>This is the second part of a series implementing an n-gram-based auto-complete system for tweets. The starting post is <a href="../auto-complete/index.html">Auto-Complete</a>.</p>
</div>
<div class="outline-3" id="outline-container-orgf557910">
<h3 id="orgf557910">Imports</h3>
<div class="outline-text-3" id="text-orgf557910">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">contain_exactly</span><span class="p">,</span>
    <span class="n">equal</span><span class="p">,</span>
    <span class="n">expect</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">nltk</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgde65f44">
<h3 id="orgde65f44">Set Up</h3>
<div class="outline-text-3" id="text-orgde65f44"></div>
<div class="outline-4" id="outline-container-org759c53d">
<h4 id="org759c53d">The Environment</h4>
<div class="outline-text-4" id="text-org759c53d">
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">"posts/nlp/.env"</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org314fa21">
<h2 id="org314fa21">Middle</h2>
<div class="outline-text-2" id="text-org314fa21"></div>
<div class="outline-3" id="outline-container-org0da0a21">
<h3 id="org0da0a21">Load the Data</h3>
<div class="outline-text-3" id="text-org0da0a21">
<p>We're going to use twitter data. There's no listing of the source, so I'm assuming it's the NLTK twitter data. But maybe not.</p>
<div class="highlight">
<pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"TWITTER_AUTOCOMPLETE"</span><span class="p">]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Data type:"</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of letters: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"First 300 letters of the data"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"-------"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">300</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"-------"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Last 300 letters of the data"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"-------"</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">300</span><span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"-------"</span><span class="p">)</span>    
</pre></div>
<pre class="example">
Data type: &lt;class 'str'&gt;
Number of letters: 3,335,477
First 300 letters of the data
-------
How are you? Btw thanks for the RT. You gonna be in DC anytime soon? Love to see you. Been way, way too long.\nWhen you meet someone special... you'll know. Your heart will beat more rapidly and you'll smile for no reason.\nthey've decided its more fun if I don't.\nSo Tired D; Played Lazer Tag & Ran A 
-------
Last 300 letters of the data
-------
ust had one a few weeks back....hopefully we will be back soon! wish you the best yo\nColombia is with an 'o'...“: We now ship to 4 countries in South America (fist pump). Please welcome Columbia to the Stunner Family”\n#GutsiestMovesYouCanMake Giving a cat a bath.\nCoffee after 5 was a TERRIBLE idea.\n
-------
</pre>
<p>So the data looks like it's just tweets, without any metadata and is separated using newlines.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgde0d47f">
<h3 id="orgde0d47f">Split To Sentences</h3>
<div class="outline-text-3" id="text-orgde0d47f">
<div class="highlight">
<pre><span></span><span class="c1"># UNQ_C1 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span>
<span class="c1">### GRADED_FUNCTION: split_to_sentences ###</span>
<span class="k">def</span> <span class="nf">split_to_sentences</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Split data by linebreak "\n"</span>

<span class="sd">    Args:</span>
<span class="sd">       data: str</span>

<span class="sd">    Returns:</span>
<span class="sd">       A list of sentences</span>
<span class="sd">    """</span>
    <span class="c1">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
    <span class="n">sentences</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">### END CODE HERE ###</span>

    <span class="c1"># Additional clearning (This part is already implemented)</span>
    <span class="c1"># - Remove leading and trailing spaces from each sentence</span>
    <span class="c1"># - Drop sentences if they are empty strings.</span>
    <span class="n">sentences</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">]</span>
    <span class="n">sentences</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sentences</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">sentences</span>
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgb752a79">
<h4 id="orgb752a79">Test The Code</h4>
<div class="outline-text-4" id="text-orgb752a79">
<div class="highlight">
<pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">I have a pen.</span><span class="se">\n</span><span class="s2">I have an apple. </span><span class="se">\n</span><span class="s2">Ah</span><span class="se">\n</span><span class="s2">Apple pen.</span><span class="se">\n</span>
<span class="s2">"""</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'I have a pen.'</span><span class="p">,</span> <span class="s1">'I have an apple.'</span><span class="p">,</span> <span class="s1">'Ah'</span><span class="p">,</span> <span class="s1">'Apple pen.'</span><span class="p">]</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">split_to_sentences</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
<pre class="example">

I have a pen.
I have an apple. 
Ah
Apple pen.

</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org5a812bb">
<h3 id="org5a812bb">Tokenize Sentences</h3>
<div class="outline-text-3" id="text-org5a812bb">
<p>The next step is to tokenize sentences (split a sentence into a list of words).</p>
<ul class="org-ul">
<li>Convert all tokens into lower case so that words which are capitalized (for example, at the start of a sentence) in the original text are treated the same as the lowercase versions of the words.</li>
<li>Append each tokenized list of words into a list of tokenized sentences.</li>
</ul>
<p><b>Hints:</b></p>
<ul class="org-ul">
<li>Use <a href="https://docs.python.org/3/library/stdtypes.html?highlight=split#str.lower%22">str.lower</a> to convert strings to lowercase.</li>
<li>Please use <a href="https://www.nltk.org/api/nltk.tokenize.html#nltk.tokenize.punkt.PunktLanguageVars.word_tokenize%22">nltk.word_tokenize</a> to split sentences into tokens.</li>
<li>If you used <code>str.split</code> insteaad of <code>nltk.word_tokenize</code>, there are additional edge cases to handle, such as the punctuation (comma, period) that follows a word.</li>
</ul>
<div class="highlight">
<pre><span></span><span class="c1"># UNQ_C2 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span>
<span class="c1">### GRADED_FUNCTION: tokenize_sentences ###</span>
<span class="k">def</span> <span class="nf">tokenize_sentences</span><span class="p">(</span><span class="n">sentences</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Tokenize sentences into tokens (words)</span>

<span class="sd">    Args:</span>
<span class="sd">       sentences: List of strings</span>

<span class="sd">    Returns:</span>
<span class="sd">       List of lists of tokens</span>
<span class="sd">    """</span>

    <span class="c1"># Initialize the list of lists of tokenized sentences</span>
    <span class="n">tokenized_sentences</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">### START CODE HERE (Replace instances of 'None' with your code) ###</span>

    <span class="c1"># Go through each sentence</span>
    <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">:</span>

        <span class="c1"># Convert to lowercase letters</span>
        <span class="n">sentence</span> <span class="o">=</span> <span class="n">sentence</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="c1"># Convert into a list of words</span>
        <span class="n">tokenized</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>

        <span class="c1"># append the list of words to the list of lists</span>
        <span class="n">tokenized_sentences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokenized</span><span class="p">)</span>

    <span class="c1">### END CODE HERE ###</span>

    <span class="k">return</span> <span class="n">tokenized_sentences</span>
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgf765fa3">
<h4 id="orgf765fa3">Test the Code</h4>
<div class="outline-text-4" id="text-orgf765fa3">
<div class="highlight">
<pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Sky is blue."</span><span class="p">,</span> <span class="s2">"Leaves are green."</span><span class="p">,</span> <span class="s2">"Roses are red."</span><span class="p">]</span>

<span class="n">expecteds</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'sky'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">'leaves'</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">,</span> <span class="s1">'green'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">'roses'</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">,</span> <span class="s1">'red'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">]]</span>

<span class="n">actuals</span> <span class="o">=</span> <span class="n">tokenize_sentences</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>
<span class="k">for</span> <span class="n">expected</span><span class="p">,</span> <span class="n">actual</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expecteds</span><span class="p">,</span> <span class="n">actuals</span><span class="p">):</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgccb59b4">
<h3 id="orgccb59b4">Combine Split Sentences and Tokenize</h3>
<div class="outline-text-3" id="text-orgccb59b4">
<div class="highlight">
<pre><span></span><span class="c1"># UNQ_C3 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span>
<span class="c1">### GRADED_FUNCTION: get_tokenized_data ###</span>
<span class="k">def</span> <span class="nf">get_tokenized_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Make a list of tokenized sentences</span>

<span class="sd">    Args:</span>
<span class="sd">       data: String</span>

<span class="sd">    Returns:</span>
<span class="sd">       List of lists of tokens</span>
<span class="sd">    """</span>
    <span class="c1">### START CODE HERE (Replace instances of 'None' with your code) ###</span>

    <span class="c1"># Get the sentences by splitting up the data</span>
    <span class="n">sentences</span> <span class="o">=</span> <span class="n">split_to_sentences</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Get the list of lists of tokens by tokenizing the sentences</span>
    <span class="n">tokenized_sentences</span> <span class="o">=</span> <span class="n">tokenize_sentences</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>

    <span class="c1">### END CODE HERE ###</span>

    <span class="k">return</span> <span class="n">tokenized_sentences</span>
</pre></div>
</div>
<div class="outline-4" id="outline-container-org52cae06">
<h4 id="org52cae06">Test It</h4>
<div class="outline-text-4" id="text-org52cae06">
<div class="highlight">
<pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s2">"Sky is blue.</span><span class="se">\n</span><span class="s2">Leaves are green</span><span class="se">\n</span><span class="s2">Roses are red."</span>
<span class="n">actuals</span> <span class="o">=</span> <span class="n">get_tokenized_data</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">expecteds</span> <span class="o">=</span>  <span class="p">[[</span><span class="s1">'sky'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">],</span>
              <span class="p">[</span><span class="s1">'leaves'</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">,</span> <span class="s1">'green'</span><span class="p">],</span>
              <span class="p">[</span><span class="s1">'roses'</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">,</span> <span class="s1">'red'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">actual</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">actuals</span><span class="p">,</span> <span class="n">expecteds</span><span class="p">):</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf2cf5b4">
<h3 id="orgf2cf5b4">Split Train and Test Sets</h3>
<div class="outline-text-3" id="text-orgf2cf5b4">
<div class="highlight">
<pre><span></span><span class="n">tokenized_data</span> <span class="o">=</span> <span class="n">get_tokenized_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">87</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">tokenized_data</span><span class="p">)</span>

<span class="n">train_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tokenized_data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">tokenized_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">tokenized_data</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">actual_data</span><span class="p">,</span> <span class="n">expected_data</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokenized_data</span><span class="p">),</span> <span class="mi">47961</span>
<span class="n">actual_training</span><span class="p">,</span> <span class="n">expected_training</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="mi">38368</span>
<span class="n">actual_testing</span><span class="p">,</span> <span class="n">expected_testing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">),</span> <span class="mi">9593</span>

<span class="nb">print</span><span class="p">((</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">actual_data</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> are split into </span><span class="si">{</span><span class="n">actual_training</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> training entries"</span>
       <span class="sa">f</span><span class="s2">" and </span><span class="si">{</span><span class="n">actual_testing</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> test set entries."</span><span class="p">))</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="s2">"data training testing"</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
        <span class="p">(</span><span class="n">actual_data</span><span class="p">,</span> <span class="n">actual_training</span><span class="p">,</span> <span class="n">actual_testing</span><span class="p">),</span>
        <span class="p">(</span><span class="n">expected_data</span><span class="p">,</span> <span class="n">expected_training</span><span class="p">,</span> <span class="n">expected_testing</span><span class="p">)):</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">expected</span><span class="p">)),</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>
<pre class="example">
47,961 are split into 38,368 training entries and 9,593 test set entries.
</pre>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"First training sample:"</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"i"</span><span class="p">,</span> <span class="s2">"personally"</span><span class="p">,</span> <span class="s2">"would"</span><span class="p">,</span> <span class="s2">"like"</span><span class="p">,</span> <span class="s2">"as"</span><span class="p">,</span> <span class="s2">"our"</span><span class="p">,</span> <span class="s2">"official"</span><span class="p">,</span> <span class="s2">"glove"</span><span class="p">,</span>
            <span class="s2">"of"</span><span class="p">,</span> <span class="s2">"the"</span><span class="p">,</span> <span class="s2">"team"</span><span class="p">,</span> <span class="s2">"local"</span><span class="p">,</span> <span class="s2">"company"</span><span class="p">,</span> <span class="s2">"and"</span><span class="p">,</span> <span class="s2">"quality"</span><span class="p">,</span>
            <span class="s2">"production"</span><span class="p">]</span>
<span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
<pre class="example">
First training sample:
['i', 'personally', 'would', 'like', 'as', 'our', 'official', 'glove', 'of', 'the', 'team', 'local', 'company', 'and', 'quality', 'production']
</pre>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"First test sample"</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"that"</span><span class="p">,</span> <span class="s2">"picture"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="s2">"just"</span><span class="p">,</span> <span class="s2">"seen"</span><span class="p">,</span> <span class="s2">"whoa"</span><span class="p">,</span> <span class="s2">"dere"</span><span class="p">,</span> <span class="s2">"!"</span><span class="p">,</span> <span class="s2">"!"</span><span class="p">,</span>
            <span class="s2">"&gt;"</span><span class="p">,</span> <span class="s2">"&gt;"</span><span class="p">,</span> <span class="s2">"&gt;"</span><span class="p">,</span> <span class="s2">"&gt;"</span><span class="p">,</span> <span class="s2">"&gt;"</span><span class="p">,</span> <span class="s2">"&gt;"</span><span class="p">,</span> <span class="s2">"&gt;"</span><span class="p">]</span>
<span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
<pre class="example">
First test sample
['that', 'picture', 'i', 'just', 'seen', 'whoa', 'dere', '!', '!', '&gt;', '&gt;', '&gt;', '&gt;', '&gt;', '&gt;', '&gt;']
</pre></div>
</div>
<div class="outline-3" id="outline-container-org5faee64">
<h3 id="org5faee64">Object-Oriented</h3>
<div class="outline-text-3" id="text-org5faee64">
<div class="highlight">
<pre><span></span><span class="o">&lt;&lt;</span><span class="n">imports</span><span class="o">&gt;&gt;</span>


<span class="o">&lt;&lt;</span><span class="n">the</span><span class="o">-</span><span class="n">tokenizer</span><span class="o">&gt;&gt;</span>

    <span class="o">&lt;&lt;</span><span class="n">sentences</span><span class="o">&gt;&gt;</span>

    <span class="o">&lt;&lt;</span><span class="n">tokenized</span><span class="o">&gt;&gt;</span>


<span class="o">&lt;&lt;</span><span class="n">train</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">split</span><span class="o">&gt;&gt;</span>

    <span class="o">&lt;&lt;</span><span class="n">shuffled</span><span class="o">-</span><span class="n">data</span><span class="o">&gt;&gt;</span>

    <span class="o">&lt;&lt;</span><span class="n">training</span><span class="o">-</span><span class="n">data</span><span class="o">&gt;&gt;</span>

    <span class="o">&lt;&lt;</span><span class="n">testing</span><span class="o">-</span><span class="n">data</span><span class="o">&gt;&gt;</span>

    <span class="o">&lt;&lt;</span><span class="n">split</span><span class="o">&gt;&gt;</span>
</pre></div>
</div>
<div class="outline-4" id="outline-container-org0e7c135">
<h4 id="org0e7c135">Imports</h4>
<div class="outline-text-4" id="text-org0e7c135">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># pypi</span>
<span class="kn">import</span> <span class="nn">attr</span>
<span class="kn">import</span> <span class="nn">nltk</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgcf3188c">
<h4 id="orgcf3188c">The Tokenizer</h4>
<div class="outline-text-4" id="text-orgcf3188c">
<div class="highlight">
<pre><span></span><span class="nd">@attr</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">auto_attribs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Tokenizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Tokenizes string sentences</span>

<span class="sd">    Args:</span>
<span class="sd">     source: string data to tokenize</span>
<span class="sd">     end_of_sentence: what to split sentences on</span>

<span class="sd">    """</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">end_of_sentence</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
    <span class="n">_sentences</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_tokenized</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_training_data</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
</pre></div>
</div>
<ul class="org-ul">
<li><a id="orgc05fffa"></a>Sentences<br>
<div class="outline-text-5" id="text-orgc05fffa">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">sentences</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""The data split into sentences"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sentences</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sentences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_of_sentence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sentences</span> <span class="o">=</span> <span class="p">(</span><span class="n">sentence</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sentences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sentences</span> <span class="o">=</span> <span class="p">[</span><span class="n">sentence</span> <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sentences</span> <span class="k">if</span> <span class="n">sentence</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sentences</span>
</pre></div>
</div>
</li>
<li><a id="org2be86c3"></a>Tokenized<br>
<div class="outline-text-5" id="text-org2be86c3">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">tokenized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""List of tokenized sentence"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenized</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tokenized</span> <span class="o">=</span> <span class="p">[</span><span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">sentence</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
                           <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sentences</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenized</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="outline-4" id="outline-container-org20a2d79">
<h4 id="org20a2d79">Train-Test-Split</h4>
<div class="outline-text-4" id="text-org20a2d79">
<div class="highlight">
<pre><span></span><span class="nd">@attr</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">auto_attribs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TrainTestSplit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""splits up the training and testing sets</span>

<span class="sd">    Args:</span>
<span class="sd">     data: list of data to split</span>
<span class="sd">     training_fraction: how much to put in the training set</span>
<span class="sd">     seed: something to seed the random call</span>
<span class="sd">    """</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">training_fraction</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.8</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">87</span>
    <span class="n">_shuffled</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_training</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_testing</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">_split</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
</pre></div>
</div>
<ul class="org-ul">
<li><a id="orge252f9b"></a>Shuffled Data<br>
<div class="outline-text-5" id="text-orge252f9b">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">shuffled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""The data shuffled"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shuffled</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shuffled</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shuffled</span>
</pre></div>
</div>
</li>
<li><a id="orgfbb384a"></a>Split<br>
<div class="outline-text-5" id="text-orgfbb384a">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""The slice value for training and testing"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_fraction</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split</span>
</pre></div>
</div>
</li>
<li><a id="org1e91194"></a>Training Data<br>
<div class="outline-text-5" id="text-org1e91194">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">training</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""The Training Portion of the Set"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_training</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training</span>
</pre></div>
</div>
</li>
<li><a id="org115d072"></a>Testing Data<br>
<div class="outline-text-5" id="text-org115d072">
<div class="highlight">
<pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">testing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""The testing data"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_testing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_testing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffled</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">:]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_testing</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="outline-4" id="outline-container-org50bb7ec">
<h4 id="org50bb7ec">Test It Out</h4>
<div class="outline-text-4" id="text-org50bb7ec"></div>
<ul class="org-ul">
<li><a id="org5ec9df6"></a>Sentences<br>
<div class="outline-text-5" id="text-org5ec9df6">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">neurotic.nlp.autocomplete</span> <span class="kn">import</span> <span class="n">Tokenizer</span><span class="p">,</span> <span class="n">TrainTestSplit</span>

<span class="n">x</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">I have a pen.</span><span class="se">\n</span><span class="s2">I have an apple. </span><span class="se">\n</span><span class="s2">Ah</span><span class="se">\n</span><span class="s2">Apple pen.</span><span class="se">\n</span>
<span class="s2">"""</span>
<span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'I have a pen.'</span><span class="p">,</span> <span class="s1">'I have an apple.'</span><span class="p">,</span> <span class="s1">'Ah'</span><span class="p">,</span> <span class="s1">'Apple pen.'</span><span class="p">]</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">actual</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">sentences</span>
<span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><a id="orgeec383d"></a>Tokens<br>
<div class="outline-text-5" id="text-orgeec383d">
<div class="highlight">
<pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">"Sky is blue."</span><span class="p">,</span> <span class="s2">"Leaves are green."</span><span class="p">,</span> <span class="s2">"Roses are red."</span><span class="p">])</span>

<span class="n">expecteds</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'sky'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">'leaves'</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">,</span> <span class="s1">'green'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">'roses'</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">,</span> <span class="s1">'red'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">]]</span>

<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="n">actuals</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenized</span>
<span class="k">for</span> <span class="n">expected</span><span class="p">,</span> <span class="n">actual</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expecteds</span><span class="p">,</span> <span class="n">actuals</span><span class="p">):</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">contain_exactly</span><span class="p">(</span><span class="o">*</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="outline-3" id="outline-container-orgaceb390">
<h3 id="orgaceb390">Training And Test Sets</h3>
<div class="outline-text-3" id="text-orgaceb390">
<div class="highlight">
<pre><span></span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">87</span><span class="p">)</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">TrainTestSplit</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenized</span><span class="p">)</span>
<span class="n">actual_data</span><span class="p">,</span> <span class="n">expected_data</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenized</span><span class="p">),</span> <span class="mi">47961</span>
<span class="n">actual_training</span><span class="p">,</span> <span class="n">expected_training</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">splitter</span><span class="o">.</span><span class="n">training</span><span class="p">),</span> <span class="mi">38368</span>
<span class="n">actual_testing</span><span class="p">,</span> <span class="n">expected_testing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">splitter</span><span class="o">.</span><span class="n">testing</span><span class="p">),</span> <span class="mi">9593</span>

<span class="nb">print</span><span class="p">((</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">actual_data</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> are split into </span><span class="si">{</span><span class="n">actual_training</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> training entries"</span>
       <span class="sa">f</span><span class="s2">" and </span><span class="si">{</span><span class="n">actual_testing</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> test set entries."</span><span class="p">))</span>

<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="s2">"data training testing"</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
        <span class="p">(</span><span class="n">actual_data</span><span class="p">,</span> <span class="n">actual_training</span><span class="p">,</span> <span class="n">actual_testing</span><span class="p">),</span>
        <span class="p">(</span><span class="n">expected_data</span><span class="p">,</span> <span class="n">expected_training</span><span class="p">,</span> <span class="n">expected_testing</span><span class="p">)):</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">expected</span><span class="p">)),</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org4623761">
<h2 id="org4623761">End</h2>
<div class="outline-text-2" id="text-org4623761">
<p>The next post in this series is <a href="../auto-complete-pre-process-the-data-ii/index.html">Pre-Processing II</a> in which we'll add counts to the tweets.</p>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/auto-complete/index.html" rel="tag">auto-complete</a></li>
<li><a class="tag p-category" href="../../../categories/n-grams/index.html" rel="tag">n-grams</a></li>
<li><a class="tag p-category" href="../../../categories/nlp/index.html" rel="tag">nlp</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../auto-complete/index.html" rel="prev" title="Auto-Complete">Previous post</a></li>
<li class="next"><a href="../auto-complete-pre-process-the-data-ii/index.html" rel="next" title="Auto-Complete: Pre-Process the Data II">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Scribbles by <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>
<div id="license" xmlns:cc="http://creativecommons.org/ns#">This work is licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" rel="license noopener noreferrer" style="display:inline-block;" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a></div>
</footer>
</div>
</div>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
