<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Combining the edits for an autocorrect system." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Autocorrect System: Combining the Edits | Neurotic Networking</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/autocorrect-system-combining-the-edits/index.html" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../site.webmanifest" rel="manifest">
<meta content="Cloistered Monkey" name="author">
<link href="../autocorrect-system-edits/index.html" rel="prev" title="Autocorrect System: Edits" type="text/html">
<link href="../autocorrect-minimum-edit-distance/index.html" rel="next" title="Autocorrect: Minimum Edit Distance" type="text/html">
<meta content="Neurotic Networking" property="og:site_name">
<meta content="Autocorrect System: Combining the Edits" property="og:title">
<meta content="https://necromuralist.github.io/Neurotic-Networking/posts/nlp/autocorrect-system-combining-the-edits/index.html" property="og:url">
<meta content="Combining the edits for an autocorrect system." property="og:description">
<meta content="article" property="og:type">
<meta content="2020-11-06T21:11:43-08:00" property="article:published_time">
<meta content="autocorrect" property="article:tag">
<meta content="nlp" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../../../"><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../pages/">Pages</a></li>
<li class="nav-item"><a class="nav-link" href="../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Monkey Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">The Cloistered Monkey</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach-Pig Rump & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href="#">Autocorrect System: Combining the Edits</a></h1>
<div class="metadata">
<p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2020-11-06T21:11:43-08:00" itemprop="datePublished" title="2020-11-06 21:11">2020-11-06 21:11</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="index.html#org6aba683">Beginning</a>
<ul>
<li><a href="index.html#org3135011">Imports</a></li>
<li><a href="index.html#org029adc7">Set Up</a></li>
</ul>
</li>
<li><a href="index.html#org12056d4">Middle</a>
<ul>
<li><a href="index.html#orgae5f23f">Combining the edits</a></li>
</ul>
</li>
<li><a href="index.html#org93dc839">End</a>
<ul>
<li><a href="index.html#org8e4da36">A Suggestor</a></li>
<li><a href="index.html#org5ba4315">Test the Suggestor</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org6aba683">
<h2 id="org6aba683">Beginning</h2>
<div class="outline-text-2" id="text-org6aba683">
<p>This is a continuation of a series of posts that were introduced <a href="../autocorrect-the-system/index.html">here</a>. Now that we've <a href="../autocorrect-system-edits/index.html">implemented the string manipulations</a>, we'll create two functions that, given a string, will return all the possible single and double edits on that string. These will be <code>edit_one_letter()</code> and <code>edit_two_letters()</code>.</p>
</div>
<div class="outline-3" id="outline-container-org3135011">
<h3 id="org3135011">Imports</h3>
<div class="outline-text-3" id="text-org3135011">
<div class="highlight">
<pre><span></span><span class="c1"># python</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># pypi</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="c1"># this repo</span>
<span class="kn">from</span> <span class="nn">neurotic.nlp.autocorrect.edits</span> <span class="kn">import</span> <span class="n">TheEditor</span>
<span class="kn">from</span> <span class="nn">neurotic.nlp.autocorrect.preprocessing</span> <span class="kn">import</span> <span class="n">CorpusBuilder</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org029adc7">
<h3 id="org029adc7">Set Up</h3>
<div class="outline-text-3" id="text-org029adc7">
<p>The CorpusBuilder has both the vocabulary and the probability for each word in the vocabulary. It gets the path to the text-file with the vocabulary in it from an envirnoment variable named <code>SHAKESPEARE</code> so we have to load that first.</p>
<div class="highlight">
<pre><span></span><span class="n">load_dotenv</span><span class="p">(</span><span class="s2">"posts/nlp/.env"</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"SHAKESPEARE"</span><span class="p">])</span>
</pre></div>
<p>And then build the corpus.</p>
<div class="highlight">
<pre><span></span><span class="n">corpus</span> <span class="o">=</span> <span class="n">CorpusBuilder</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org12056d4">
<h2 id="org12056d4">Middle</h2>
<div class="outline-text-2" id="text-org12056d4"></div>
<div class="outline-3" id="outline-container-orgae5f23f">
<h3 id="orgae5f23f">Combining the edits</h3>
<div class="outline-text-3" id="text-orgae5f23f"></div>
<div class="outline-4" id="outline-container-org7ef2b22">
<h4 id="org7ef2b22">Edit one letter</h4>
<div class="outline-text-4" id="text-org7ef2b22">
<p><b>Instructions</b>: Implement the <code>edit_one_letter</code> function to get all the possible edits that are one edit away from a word. The edits consist of the replace, insert, delete, and optionally the switch operation. You should use the previous functions you have already implemented to complete this function. The 'switch' function is a less common edit function, so its use will be selected by an "allow_switches" input argument.</p>
<p>Note that those functions return <b>lists</b> while this function should return a <b>python set</b>. Utilizing a set eliminates any duplicate entries.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">edit_one_letter</span><span class="p">(</span><span class="n">word</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">allow_switches</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Get all possible words one edit away from the original</span>

<span class="sd">    Args:</span>
<span class="sd">      word: word for which we will generate all possible words one edit away.</span>

<span class="sd">    Returns:</span>
<span class="sd">      edit_one_set: a set of words with one possible edit.</span>
<span class="sd">    """</span>

    <span class="n">edit_one_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">editor</span> <span class="o">=</span> <span class="n">TheEditor</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">edits</span> <span class="o">=</span> <span class="n">editor</span><span class="o">.</span><span class="n">replaced</span> <span class="o">+</span> <span class="n">editor</span><span class="o">.</span><span class="n">inserted</span> <span class="o">+</span> <span class="n">editor</span><span class="o">.</span><span class="n">deleted</span>
    <span class="k">if</span> <span class="n">allow_switches</span><span class="p">:</span>
        <span class="n">edits</span> <span class="o">+=</span> <span class="n">editor</span><span class="o">.</span><span class="n">switched</span>
    <span class="n">edit_one_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">edits</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">edit_one_set</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">tmp_word</span> <span class="o">=</span> <span class="s2">"at"</span>
<span class="n">tmp_edit_one_set</span> <span class="o">=</span> <span class="n">edit_one_letter</span><span class="p">(</span><span class="n">tmp_word</span><span class="p">)</span>
<span class="c1"># turn this into a list to sort it, in order to view it</span>
<span class="n">tmp_edit_one_l</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tmp_edit_one_set</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"input word </span><span class="si">{</span><span class="n">tmp_word</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">edit_one_l </span><span class="se">\n</span><span class="si">{</span><span class="n">tmp_edit_one_l</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The type of the returned object should be a set </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">tmp_edit_one_set</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of outputs from edit_one_letter('at') is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">edit_one_letter</span><span class="p">(</span><span class="s1">'at'</span><span class="p">))</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'aa'</span><span class="p">,</span> <span class="s1">'aat'</span><span class="p">,</span> <span class="s1">'ab'</span><span class="p">,</span> <span class="s1">'abt'</span><span class="p">,</span> <span class="s1">'ac'</span><span class="p">,</span> <span class="s1">'act'</span><span class="p">,</span> <span class="s1">'ad'</span><span class="p">,</span> <span class="s1">'adt'</span><span class="p">,</span> <span class="s1">'ae'</span><span class="p">,</span> <span class="s1">'aet'</span><span class="p">,</span> <span class="s1">'af'</span><span class="p">,</span> <span class="s1">'aft'</span><span class="p">,</span> <span class="s1">'ag'</span><span class="p">,</span> <span class="s1">'agt'</span><span class="p">,</span> <span class="s1">'ah'</span><span class="p">,</span> <span class="s1">'aht'</span><span class="p">,</span> <span class="s1">'ai'</span><span class="p">,</span> <span class="s1">'ait'</span><span class="p">,</span> <span class="s1">'aj'</span><span class="p">,</span> <span class="s1">'ajt'</span><span class="p">,</span> <span class="s1">'ak'</span><span class="p">,</span> <span class="s1">'akt'</span><span class="p">,</span> <span class="s1">'al'</span><span class="p">,</span> <span class="s1">'alt'</span><span class="p">,</span> <span class="s1">'am'</span><span class="p">,</span> <span class="s1">'amt'</span><span class="p">,</span> <span class="s1">'an'</span><span class="p">,</span> <span class="s1">'ant'</span><span class="p">,</span> <span class="s1">'ao'</span><span class="p">,</span> <span class="s1">'aot'</span><span class="p">,</span> <span class="s1">'ap'</span><span class="p">,</span> <span class="s1">'apt'</span><span class="p">,</span> <span class="s1">'aq'</span><span class="p">,</span> <span class="s1">'aqt'</span><span class="p">,</span> <span class="s1">'ar'</span><span class="p">,</span> <span class="s1">'art'</span><span class="p">,</span> <span class="s1">'as'</span><span class="p">,</span> <span class="s1">'ast'</span><span class="p">,</span> <span class="s1">'ata'</span><span class="p">,</span> <span class="s1">'atb'</span><span class="p">,</span> <span class="s1">'atc'</span><span class="p">,</span> <span class="s1">'atd'</span><span class="p">,</span> <span class="s1">'ate'</span><span class="p">,</span> <span class="s1">'atf'</span><span class="p">,</span> <span class="s1">'atg'</span><span class="p">,</span> <span class="s1">'ath'</span><span class="p">,</span> <span class="s1">'ati'</span><span class="p">,</span> <span class="s1">'atj'</span><span class="p">,</span> <span class="s1">'atk'</span><span class="p">,</span> <span class="s1">'atl'</span><span class="p">,</span> <span class="s1">'atm'</span><span class="p">,</span> <span class="s1">'atn'</span><span class="p">,</span> <span class="s1">'ato'</span><span class="p">,</span> <span class="s1">'atp'</span><span class="p">,</span> <span class="s1">'atq'</span><span class="p">,</span> <span class="s1">'atr'</span><span class="p">,</span> <span class="s1">'ats'</span><span class="p">,</span> <span class="s1">'att'</span><span class="p">,</span> <span class="s1">'atu'</span><span class="p">,</span> <span class="s1">'atv'</span><span class="p">,</span> <span class="s1">'atw'</span><span class="p">,</span> <span class="s1">'atx'</span><span class="p">,</span> <span class="s1">'aty'</span><span class="p">,</span> <span class="s1">'atz'</span><span class="p">,</span> <span class="s1">'au'</span><span class="p">,</span> <span class="s1">'aut'</span><span class="p">,</span> <span class="s1">'av'</span><span class="p">,</span> <span class="s1">'avt'</span><span class="p">,</span> <span class="s1">'aw'</span><span class="p">,</span> <span class="s1">'awt'</span><span class="p">,</span> <span class="s1">'ax'</span><span class="p">,</span> <span class="s1">'axt'</span><span class="p">,</span> <span class="s1">'ay'</span><span class="p">,</span> <span class="s1">'ayt'</span><span class="p">,</span> <span class="s1">'az'</span><span class="p">,</span> <span class="s1">'azt'</span><span class="p">,</span> <span class="s1">'bat'</span><span class="p">,</span> <span class="s1">'bt'</span><span class="p">,</span> <span class="s1">'cat'</span><span class="p">,</span> <span class="s1">'ct'</span><span class="p">,</span> <span class="s1">'dat'</span><span class="p">,</span> <span class="s1">'dt'</span><span class="p">,</span> <span class="s1">'eat'</span><span class="p">,</span> <span class="s1">'et'</span><span class="p">,</span> <span class="s1">'fat'</span><span class="p">,</span> <span class="s1">'ft'</span><span class="p">,</span> <span class="s1">'gat'</span><span class="p">,</span> <span class="s1">'gt'</span><span class="p">,</span> <span class="s1">'hat'</span><span class="p">,</span> <span class="s1">'ht'</span><span class="p">,</span> <span class="s1">'iat'</span><span class="p">,</span> <span class="s1">'it'</span><span class="p">,</span> <span class="s1">'jat'</span><span class="p">,</span> <span class="s1">'jt'</span><span class="p">,</span> <span class="s1">'kat'</span><span class="p">,</span> <span class="s1">'kt'</span><span class="p">,</span> <span class="s1">'lat'</span><span class="p">,</span> <span class="s1">'lt'</span><span class="p">,</span> <span class="s1">'mat'</span><span class="p">,</span> <span class="s1">'mt'</span><span class="p">,</span> <span class="s1">'nat'</span><span class="p">,</span> <span class="s1">'nt'</span><span class="p">,</span> <span class="s1">'oat'</span><span class="p">,</span> <span class="s1">'ot'</span><span class="p">,</span> <span class="s1">'pat'</span><span class="p">,</span> <span class="s1">'pt'</span><span class="p">,</span> <span class="s1">'qat'</span><span class="p">,</span> <span class="s1">'qt'</span><span class="p">,</span> <span class="s1">'rat'</span><span class="p">,</span> <span class="s1">'rt'</span><span class="p">,</span> <span class="s1">'sat'</span><span class="p">,</span> <span class="s1">'st'</span><span class="p">,</span> <span class="s1">'t'</span><span class="p">,</span> <span class="s1">'ta'</span><span class="p">,</span> <span class="s1">'tat'</span><span class="p">,</span> <span class="s1">'tt'</span><span class="p">,</span> <span class="s1">'uat'</span><span class="p">,</span> <span class="s1">'ut'</span><span class="p">,</span> <span class="s1">'vat'</span><span class="p">,</span> <span class="s1">'vt'</span><span class="p">,</span> <span class="s1">'wat'</span><span class="p">,</span> <span class="s1">'wt'</span><span class="p">,</span> <span class="s1">'xat'</span><span class="p">,</span> <span class="s1">'xt'</span><span class="p">,</span> <span class="s1">'yat'</span><span class="p">,</span> <span class="s1">'yt'</span><span class="p">,</span> <span class="s1">'zat'</span><span class="p">,</span> <span class="s1">'zt'</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">tmp_edit_one_l</span> <span class="o">==</span> <span class="n">expected</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">edit_one_letter</span><span class="p">(</span><span class="s2">"at"</span><span class="p">))</span> <span class="o">==</span> <span class="mi">129</span>
</pre></div>
<pre class="example">
input word at 
edit_one_l 
['a', 'aa', 'aat', 'ab', 'abt', 'ac', 'act', 'ad', 'adt', 'ae', 'aet', 'af', 'aft', 'ag', 'agt', 'ah', 'aht', 'ai', 'ait', 'aj', 'ajt', 'ak', 'akt', 'al', 'alt', 'am', 'amt', 'an', 'ant', 'ao', 'aot', 'ap', 'apt', 'aq', 'aqt', 'ar', 'art', 'as', 'ast', 'ata', 'atb', 'atc', 'atd', 'ate', 'atf', 'atg', 'ath', 'ati', 'atj', 'atk', 'atl', 'atm', 'atn', 'ato', 'atp', 'atq', 'atr', 'ats', 'att', 'atu', 'atv', 'atw', 'atx', 'aty', 'atz', 'au', 'aut', 'av', 'avt', 'aw', 'awt', 'ax', 'axt', 'ay', 'ayt', 'az', 'azt', 'bat', 'bt', 'cat', 'ct', 'dat', 'dt', 'eat', 'et', 'fat', 'ft', 'gat', 'gt', 'hat', 'ht', 'iat', 'it', 'jat', 'jt', 'kat', 'kt', 'lat', 'lt', 'mat', 'mt', 'nat', 'nt', 'oat', 'ot', 'pat', 'pt', 'qat', 'qt', 'rat', 'rt', 'sat', 'st', 't', 'ta', 'tat', 'tt', 'uat', 'ut', 'vat', 'vt', 'wat', 'wt', 'xat', 'xt', 'yat', 'yt', 'zat', 'zt']

The type of the returned object should be a set &lt;class 'set'&gt;
Number of outputs from edit_one_letter('at') is 129
</pre></div>
</div>
<div class="outline-4" id="outline-container-orgd96d011">
<h4 id="orgd96d011">Edit two letters</h4>
<div class="outline-text-4" id="text-orgd96d011">
<p>Now you can generalize this to implement to get two edits on a word. To do so, you would have to get all the possible edits on a single word and then for each modified word, you would have to modify it again.</p>
<p><b>Instructions</b>: Implement the <code>edit_two_letters</code> function that returns a set of words that are two edits away. Note that creating additional edits based on the <code>edit_one_letter</code> function may 'restore' some one_edits to zero or one edits. That is allowed here. This accounted for in get_corrections.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">edit_two_letters</span><span class="p">(</span><span class="n">word</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">allow_switches</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Make two-letter edits</span>

<span class="sd">    Args:</span>
<span class="sd">      word: the input string/word </span>

<span class="sd">    Returns:</span>
<span class="sd">       edit_two_set: a set of strings with all possible two edits</span>
<span class="sd">    """</span>

    <span class="n">edit_two_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">ones</span> <span class="o">=</span> <span class="n">edit_one_letter</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">allow_switches</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">ones</span><span class="p">:</span>
        <span class="n">edit_two_set</span> <span class="o">=</span> <span class="n">edit_two_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">edit_one_letter</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">allow_switches</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">edit_two_set</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">tmp_edit_two_set</span> <span class="o">=</span> <span class="n">edit_two_letters</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)</span>
<span class="n">tmp_edit_two_l</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tmp_edit_two_set</span><span class="p">))</span>
<span class="n">twos</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_edit_two_l</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">twos</span> <span class="o">==</span> <span class="mi">2654</span><span class="p">,</span> <span class="n">twos</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of strings with edit distance of two: </span><span class="si">{</span><span class="n">twos</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">first_ten</span> <span class="o">=</span> <span class="n">tmp_edit_two_l</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">first_ten</span> <span class="o">==</span> <span class="p">[</span><span class="s1">''</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'aa'</span><span class="p">,</span> <span class="s1">'aaa'</span><span class="p">,</span> <span class="s1">'aab'</span><span class="p">,</span> <span class="s1">'aac'</span><span class="p">,</span> <span class="s1">'aad'</span><span class="p">,</span> <span class="s1">'aae'</span><span class="p">,</span> <span class="s1">'aaf'</span><span class="p">,</span> <span class="s1">'aag'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"First 10 strings </span><span class="si">{</span><span class="n">first_ten</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">last_ten</span> <span class="o">=</span> <span class="n">tmp_edit_two_l</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="k">assert</span> <span class="n">last_ten</span> <span class="o">==</span> <span class="p">[</span><span class="s1">'zv'</span><span class="p">,</span> <span class="s1">'zva'</span><span class="p">,</span> <span class="s1">'zw'</span><span class="p">,</span> <span class="s1">'zwa'</span><span class="p">,</span> <span class="s1">'zx'</span><span class="p">,</span> <span class="s1">'zxa'</span><span class="p">,</span> <span class="s1">'zy'</span><span class="p">,</span> <span class="s1">'zya'</span><span class="p">,</span> <span class="s1">'zz'</span><span class="p">,</span> <span class="s1">'zza'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Last 10 strings </span><span class="si">{</span><span class="n">last_ten</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The data type of the returned object should be a set </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">tmp_edit_two_set</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">actual</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">edit_two_letters</span><span class="p">(</span><span class="s1">'at'</span><span class="p">))</span>
<span class="n">expected</span> <span class="o">=</span> <span class="mi">7154</span>
<span class="k">assert</span> <span class="n">expected</span> <span class="o">==</span> <span class="n">actual</span><span class="p">,</span> <span class="n">actual</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of strings that are 2 edit distances from 'at' is </span><span class="si">{</span><span class="n">actual</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Number of strings with edit distance of two: 2654
First 10 strings ['', 'a', 'aa', 'aaa', 'aab', 'aac', 'aad', 'aae', 'aaf', 'aag']
Last 10 strings ['zv', 'zva', 'zw', 'zwa', 'zx', 'zxa', 'zy', 'zya', 'zz', 'zza']
The data type of the returned object should be a set &lt;class 'set'&gt;
Number of strings that are 2 edit distances from 'at' is 7154
</pre></div>
</div>
<div class="outline-4" id="outline-container-org551f48c">
<h4 id="org551f48c">Suggest Spelling Corrections</h4>
<div class="outline-text-4" id="text-org551f48c">
<p>Now you will use your <code>edit_two_letters</code> function to get a set of all the possible 2 edits on your word. You will then use those strings to get the most probable word you meant to type aka your typing suggestion.</p>
<p><b>Instructions</b>: Implement <code>get_corrections</code>, which returns a list of zero to n possible suggestion tuples of the form (word, probability_of_word).</p>
<ul class="org-ul">
<li><b>Step 1:</b> Generate suggestions for a supplied word: You'll use the edit functions you have developed. The 'suggestion algorithm' should follow this logic:
<ul class="org-ul">
<li>If the word is in the vocabulary, suggest the word.</li>
<li>Otherwise, if there are suggestions from <code>edit_one_letter</code> that are in the vocabulary, use those.</li>
<li>Otherwise, if there are suggestions from <code>edit_two_letters</code> that are in the vocabulary, use those.</li>
<li>Otherwise, suggest the input word.*</li>
<li>The idea is that words generated from fewer edits are more likely than words with more edits.</li>
</ul>
</li>
</ul>
<p>Note:</p>
<ul class="org-ul">
<li>Edits of one or two letters may 'restore' strings to either zero or one edit. This algorithm accounts for this by preferentially selecting lower distance edits first.</li>
</ul>
</div>
<ul class="org-ul">
<li><a id="orgbf5613b"></a>Short circuit<br>
<div class="outline-text-5" id="text-orgbf5613b">
<p>In Python, logical operations such as <code>and</code> and <code>or</code> have two useful properties. They can operate on lists and they have ['short-circuit' behavior](<a href="https://docs.python.org/3/library/stdtypes.html">https://docs.python.org/3/library/stdtypes.html</a>). Try these:</p>
<p>Example of logical operation on lists or sets.</p>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="p">[]</span> <span class="ow">and</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span><span class="s2">"b"</span><span class="p">]</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="p">[]</span> <span class="ow">or</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span><span class="s2">"b"</span><span class="p">]</span> <span class="p">)</span>
<span class="c1">#example of Short circuit behavior</span>
<span class="n">val1</span> <span class="o">=</span>  <span class="p">[</span><span class="s2">"Most"</span><span class="p">,</span><span class="s2">"Likely"</span><span class="p">]</span> <span class="ow">or</span> <span class="p">[</span><span class="s2">"Less"</span><span class="p">,</span><span class="s2">"so"</span><span class="p">]</span> <span class="ow">or</span> <span class="p">[</span><span class="s2">"least"</span><span class="p">,</span><span class="s2">"of"</span><span class="p">,</span><span class="s2">"all"</span><span class="p">]</span>  <span class="c1"># selects first, does not evalute remainder</span>
<span class="nb">print</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span>
<span class="n">val2</span> <span class="o">=</span>  <span class="p">[]</span> <span class="ow">or</span> <span class="p">[]</span> <span class="ow">or</span> <span class="p">[</span><span class="s2">"least"</span><span class="p">,</span><span class="s2">"of"</span><span class="p">,</span><span class="s2">"all"</span><span class="p">]</span> <span class="c1"># continues evaluation until there is a non-empty list</span>
<span class="nb">print</span><span class="p">(</span><span class="n">val2</span><span class="p">)</span>
</pre></div>
<pre class="example">
[]
['a', 'b']
['Most', 'Likely']
['least', 'of', 'all']
</pre>
<p>The logical <code>or</code> could be used to implement the suggestion algorithm very compactly. Alternately, if/then constructs could be used.</p>
<p><b>Step 2</b>: Create a 'best_words' dictionary where the 'key' is a suggestion and the 'value' is the probability of that word in your vocabulary. If the word is not in the vocabulary, assign it a probability of 0.</p>
<p><b>Step 3</b>: Select the n best suggestions. There may be fewer than n.</p>
<ul class="org-ul">
<li><code>edit_one_letter</code> and <code>edit_two_letters</code> return <b>python sets</b>.</li>
<li>Sets have a handy <a href="https://docs.python.org/2/library/sets.html">set.intersection</a> feature</li>
<li>To find the keys that have the highest values in a dictionary, you can use the Counter dictionary to create a Counter object from a regular dictionary. Then you can use Counter.most_common(n) to get the n most common keys.</li>
<li>To find the intersection of two sets, you can use set.intersection or the & operator.</li>
<li>If you are not as familiar with short circuit syntax (as shown above), feel free to use if else statements instead.</li>
<li>To use an if statement to check of a set is empty, use 'if not x:' syntax</li>
</ul>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">get_corrections</span><span class="p">(</span><span class="n">word</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">probs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">vocab</span><span class="p">:</span> <span class="nb">set</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Gets corrections within n edits</span>

<span class="sd">    Args: </span>
<span class="sd">       word: a user entered string to check for suggestions</span>
<span class="sd">       probs: a dictionary that maps each word to its probability in the corpus</span>
<span class="sd">       vocab: a set containing all the vocabulary</span>
<span class="sd">       n: number of possible word corrections you want returned in the dictionary</span>

<span class="sd">    Returns: </span>
<span class="sd">       n_best: a list of tuples with the most probable n corrected words and their probabilities.</span>
<span class="sd">    """</span>

    <span class="n">suggestions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_best</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocab</span><span class="p">:</span>
        <span class="n">n_best</span> <span class="o">=</span> <span class="p">[(</span><span class="n">word</span><span class="p">,</span> <span class="n">probs</span><span class="p">[</span><span class="n">word</span><span class="p">])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">suggestions</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">edit_one_letter</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">suggestions</span><span class="p">:</span>
            <span class="n">suggestions</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">edit_two_letters</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">suggestions</span><span class="p">:</span>
            <span class="n">probabilities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([(</span><span class="n">probs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">suggestion</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">suggestion</span><span class="p">)</span>
                                <span class="k">for</span> <span class="n">suggestion</span> <span class="ow">in</span> <span class="n">suggestions</span><span class="p">])))</span>
            <span class="n">n_best</span> <span class="o">=</span> <span class="p">[(</span><span class="n">word</span><span class="p">,</span> <span class="n">probability</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">probability</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span> <span class="ow">in</span> <span class="n">probabilities</span><span class="p">[:</span><span class="n">n</span><span class="p">]]</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"entered word = "</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">suggestions = "</span><span class="p">,</span> <span class="n">suggestions</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">n_best</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">word</span> <span class="o">=</span> <span class="s2">"dbadd"</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">get_corrections</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">probs</span><span class="o">=</span><span class="n">corpus</span><span class="o">.</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">vocab</span><span class="o">=</span><span class="n">corpus</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
<pre class="example">
entered word =  dbadd 
suggestions =  {'bade', 'band', 'add', 'dead', 'bad'}
[('dead', 0.0006341627186928787), ('bad', 0.0002051702913418137)]
</pre>
<div class="highlight">
<pre><span></span><span class="n">word</span> <span class="o">=</span> <span class="s2">"days"</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">get_corrections</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">probs</span><span class="o">=</span><span class="n">corpus</span><span class="o">.</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">vocab</span><span class="o">=</span><span class="n">corpus</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">test</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
<pre class="example">
entered word =  days 
suggestions =  []
[('days', 0.0004103405826836274)]
</pre>
<div class="highlight">
<pre><span></span><span class="c1"># Test your implementation - feel free to try other words in my word</span>
<span class="n">my_word</span> <span class="o">=</span> <span class="s1">'dys'</span>
<span class="n">tmp_corrections</span> <span class="o">=</span> <span class="n">get_corrections</span><span class="p">(</span><span class="n">my_word</span><span class="p">,</span> <span class="n">corpus</span><span class="o">.</span><span class="n">probabilities</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="n">words</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># keep verbose=True</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">word_prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tmp_corrections</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"word </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">word_prob</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, probability </span><span class="si">{</span><span class="n">word_prob</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"data type of corrections </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">tmp_corrections</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">expected</span> <span class="o">=</span> <span class="mf">0.000410</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">tmp_corrections</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">),</span> <span class="n">actual</span>

<span class="n">expected</span> <span class="o">=</span> <span class="mf">0.000019</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">tmp_corrections</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">),</span> <span class="n">actual</span>
</pre></div>
<pre class="example">
entered word =  dys 
suggestions =  {'days', 'dye'}
word 0: days, probability 0.000410
word 1: dye, probability 0.000019
data type of corrections &lt;class 'list'&gt;
</pre></div>
</li>
</ul>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org93dc839">
<h2 id="org93dc839">End</h2>
<div class="outline-text-2" id="text-org93dc839">
<p>The next step is to write some code to find the <a href="../autocorrect-minimum-edit-distance/index.html">Minimum Edit Distance</a> needed to transform one word into another word.</p>
</div>
<div class="outline-3" id="outline-container-org8e4da36">
<h3 id="org8e4da36">A Suggestor</h3>
<div class="outline-text-3" id="text-org8e4da36"></div>
<div class="outline-4" id="outline-container-orgd2bf608">
<h4 id="orgd2bf608">Imports</h4>
<div class="outline-text-4" id="text-orgd2bf608">
<div class="highlight">
<pre><span></span><span class="c1"># pypi</span>
<span class="kn">import</span> <span class="nn">attr</span>

<span class="c1"># this repository</span>
<span class="kn">from</span> <span class="nn">neurotic.nlp.autocorrect.edits</span> <span class="kn">import</span> <span class="n">TheEditor</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org451946a">
<h4 id="org451946a">The Suggestor</h4>
<div class="outline-text-4" id="text-org451946a">
<div class="highlight">
<pre><span></span><span class="nd">@attr</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">auto_attribs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">WordSuggestor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Suggests Words for Autocorrection</span>

<span class="sd">    Args:</span>
<span class="sd">     corpus: a Corpus Builder object</span>
<span class="sd">     suggestions: number of suggestions to return for each word</span>
<span class="sd">     want_switches: also do the =switch= edit</span>
<span class="sd">    """</span>
    <span class="n">corpus</span><span class="p">:</span> <span class="nb">object</span>
    <span class="n">suggestions</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">want_switches</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org3de797c">
<h4 id="org3de797c">Edit One Letter</h4>
<div class="outline-text-4" id="text-org3de797c">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">one_letter_edits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Get all possible words one edit away from the original</span>

<span class="sd">    Args:</span>
<span class="sd">      word: word for which we will generate all possible words one edit away.</span>

<span class="sd">    Returns:</span>
<span class="sd">      set of words with one possible edit.</span>
<span class="sd">    """</span>    
    <span class="n">editor</span> <span class="o">=</span> <span class="n">TheEditor</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">edits</span> <span class="o">=</span> <span class="n">editor</span><span class="o">.</span><span class="n">replaced</span> <span class="o">+</span> <span class="n">editor</span><span class="o">.</span><span class="n">inserted</span> <span class="o">+</span> <span class="n">editor</span><span class="o">.</span><span class="n">deleted</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">want_switches</span><span class="p">:</span>
        <span class="n">edits</span> <span class="o">+=</span> <span class="n">editor</span><span class="o">.</span><span class="n">switched</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">edits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org8bb0246">
<h4 id="org8bb0246">Two-Letter Edits</h4>
<div class="outline-text-4" id="text-org8bb0246">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">two_letter_edits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Make two-letter edits</span>

<span class="sd">    Args:</span>
<span class="sd">      word: the input string/word </span>

<span class="sd">    Returns:</span>
<span class="sd">      set of strings with all possible two-letter edits</span>
<span class="sd">    """</span>
    <span class="n">ones</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_letter_edits</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">one_letter_edits</span><span class="p">(</span><span class="n">one</span><span class="p">)</span> <span class="k">for</span> <span class="n">one</span> <span class="ow">in</span> <span class="n">ones</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orga6a5e5e">
<h4 id="orga6a5e5e">The Call</h4>
<div class="outline-text-4" id="text-orga6a5e5e">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Finds the closest words to the word</span>

<span class="sd">    If the word is in our corpus then it just returns the word</span>

<span class="sd">    Args:</span>
<span class="sd">     word: potential word to correct</span>

<span class="sd">    Returns:</span>
<span class="sd">     list of (word, probability) tuples</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">:</span>
        <span class="n">best</span> <span class="o">=</span> <span class="p">[(</span><span class="n">word</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">probabilities</span><span class="p">[</span><span class="n">word</span><span class="p">])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">suggestions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">vocabulary</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">one_letter_edits</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">suggestions</span><span class="p">:</span>
            <span class="n">suggestions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">vocabulary</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">two_letter_edits</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">suggestions</span><span class="p">:</span>
            <span class="n">probabilities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span>
                <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">probabilities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">suggestion</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">suggestion</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">suggestion</span> <span class="ow">in</span> <span class="n">suggestions</span><span class="p">])))</span>
            <span class="n">best</span> <span class="o">=</span> <span class="p">[(</span><span class="n">word</span><span class="p">,</span> <span class="n">probability</span><span class="p">)</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">probability</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span> <span class="ow">in</span> <span class="n">probabilities</span><span class="p">[</span>
                            <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">suggestions</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">best</span> <span class="o">=</span> <span class="p">[(</span><span class="n">word</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">best</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org5ba4315">
<h3 id="org5ba4315">Test the Suggestor</h3>
<div class="outline-text-3" id="text-org5ba4315">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">neurotic.nlp.autocorrect.suggestor</span> <span class="kn">import</span> <span class="n">WordSuggestor</span>
<span class="n">suggestor</span> <span class="o">=</span> <span class="n">WordSuggestor</span><span class="p">(</span><span class="n">corpus</span><span class="o">=</span><span class="n">corpus</span><span class="p">,</span> <span class="n">suggestions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="c1"># this doesn't have any one-letter-edits in the corpus so it won't return anything</span>
<span class="c1"># unless the two-letter-edits is working</span>
<span class="n">word</span> <span class="o">=</span> <span class="s2">"dbadd"</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">suggestor</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
<pre class="example">
[('dead', 0.0006341627186928787), ('bad', 0.0002051702913418137)]
</pre>
<div class="highlight">
<pre><span></span><span class="n">word</span> <span class="o">=</span> <span class="s2">"days"</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">suggestor</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">test</span>
<span class="k">assert</span> <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">word</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
<pre class="example">
[('days', 0.0004103405826836274)]
</pre>
<div class="highlight">
<pre><span></span><span class="n">word</span> <span class="o">=</span> <span class="s1">'dys'</span>
<span class="n">tmp_corrections</span> <span class="o">=</span> <span class="n">suggestor</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">word_prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tmp_corrections</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"word </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">word_prob</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, probability </span><span class="si">{</span><span class="n">word_prob</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"data type of corrections </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">tmp_corrections</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">expected</span> <span class="o">=</span> <span class="mf">0.000410</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">tmp_corrections</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">),</span> <span class="n">actual</span>

<span class="n">expected</span> <span class="o">=</span> <span class="mf">0.000019</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">tmp_corrections</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">),</span> <span class="n">actual</span>
</pre></div>
<pre class="example">
word 0: days, probability 0.000410
word 1: dye, probability 0.000019
data type of corrections &lt;class 'list'&gt;
</pre></div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/autocorrect/index.html" rel="tag">autocorrect</a></li>
<li><a class="tag p-category" href="../../../categories/nlp/index.html" rel="tag">nlp</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../autocorrect-system-edits/index.html" rel="prev" title="Autocorrect System: Edits">Previous post</a></li>
<li class="next"><a href="../autocorrect-minimum-edit-distance/index.html" rel="next" title="Autocorrect: Minimum Edit Distance">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Scribbles by <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>
<div id="license" xmlns:cc="http://creativecommons.org/ns#">This work is licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" rel="license noopener noreferrer" style="display:inline-block;" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a></div>
</footer>
</div>
</div>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
