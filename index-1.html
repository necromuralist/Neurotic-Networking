<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Studies in Deep Learning." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Neurotic Networking (old posts, page 1) | Neurotic Networking</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Neurotic-Networking/index-1.html" rel="canonical">
<link href="index-2.html" rel="prev" type="text/html"><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
<link href="apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="site.webmanifest" rel="manifest">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="."><span id="blog-title">Neurotic Networking</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Monkey Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">The Cloistered Monkey</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach-Pig Rump & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- Google custom search -->
<form action="https://www.google.com/search" class="navbar-form navbar-right" method="get" role="search">
<div class="form-group"><input class="form-control" name="q" placeholder="Search" type="text"></div>
<!-- 
<button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-search"></span>
</button>
-->
<input name="sitesearch" type="hidden" value="https://necromuralist.github.io/Neurotic-Networking/"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/nano/introduction-to-neural-networks/softmax/index.html">Softmax</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/nano/introduction-to-neural-networks/softmax/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-23T07:44:24-07:00" itemprop="datePublished" title="2018-10-23 07:44">2018-10-23 07:44</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/nano/introduction-to-neural-networks/softmax/index.html#orgda02865">What is the Softmax Function?</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/softmax/index.html#orgb2558f8">A classification problem</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/softmax/index.html#orgfb341f4">The Exponential</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/softmax/index.html#orgd410b2f">Implementation</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgda02865">
<h2 id="orgda02865">What is the Softmax Function?</h2>
<div class="outline-text-2" id="text-orgda02865">
<p>With the stepwise and logistic function you are limited to binary classifications. The <a href="https://en.wikipedia.org/wiki/Softmax_function">softmax</a> function is a generalization of the logistic (sigmoid) function that lets you choose between multiple categories.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgb2558f8">
<h2 id="orgb2558f8">A classification problem</h2>
<div class="outline-text-2" id="text-orgb2558f8"></div>
<div class="outline-3" id="outline-container-org2add656">
<h3 id="org2add656">What animal did you see?</h3>
<div class="outline-text-3" id="text-org2add656">
<p>We have three animals and the probabilities that the animal you saw are the following:</p>
<ul class="org-ul">
<li>P(duck) = 0.67</li>
<li>P(beaver) = 0.24</li>
<li>P(walrus) = 0.09</li>
</ul>
<p>We count the occurrence of animals we see and get these counts.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Animal</th>
<th class="org-right" scope="col">Count</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Duck</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Beaver</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Walrus</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>So, how do you convert these scores into probabilities?</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgae22710">
<h3 id="orgae22710">Standardize</h3>
<div class="outline-text-3" id="text-orgae22710">
<p>One way to convert the counts to probabilities is by dividing each count by the total.</p>
<p>\[ P = \frac{count}{\textit{total count}} \]</p>
<p>The problem with this is we might not be dealing with counts and so we have to deal with negative numbers in which case the sum of the values (total count in this case) could equal zero. We need to use a function that will turn any value we have (even if it isn't a count) into a positive number.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgb17285f">
<h3 id="orgb17285f">Which function would turn every number into a positive number?</h3>
<div class="outline-text-3" id="text-orgb17285f">
<ul class="org-ul">
<li class="off"><code>[&nbsp;]</code> sin</li>
<li class="off"><code>[&nbsp;]</code> cos</li>
<li class="off"><code>[&nbsp;]</code> log</li>
<li class="on"><code>[X]</code> exp</li>
</ul>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgfb341f4">
<h2 id="orgfb341f4">The Exponential</h2>
<div class="outline-text-2" id="text-orgfb341f4">
<p>It turns out that if you take the numbers and use them as the power of <i>e</i>, your values will always be positive, so to normalize our values, instead of taking the count divided by the sum of the counts, we would take the exponential of our count divided by the sum of the exponentials of all the counts.</p>
<p>\[ P(duck) = \frac{e^2}{e^2 + e^1 + e^0}\\ = 0.67 \]</p>
<p>This is the <i>softmax</i> function.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgd410b2f">
<h2 id="orgd410b2f">Implementation</h2>
<div class="outline-text-2" id="text-orgd410b2f"></div>
<div class="outline-3" id="outline-container-orgf212198">
<h3 id="orgf212198">Imports</h3>
<div class="outline-text-3" id="text-orgf212198">
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
<p>Write a function that takes as input a list of numbers, and returns the list of values given by the softmax function. This uses <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.exp.html">numpy.exp</a> to approximate <a href="https://en.wikipedia.org/wiki/E_(mathematical_constant)">e</a>.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""calculates the softmax probmabilities</span>

<span class="sd">    Args:</span>
<span class="sd">     L: List of values</span>

<span class="sd">    Returns:</span>
<span class="sd">     softmax: the softmax probabilities for the values</span>
<span class="sd">    """</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span><span class="o">/</span><span class="n">values</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">]</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">2</span>
<span class="n">expected_actual</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">expected_values</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">expected_actual</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">actual</span><span class="p">))</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">actual</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">,</span>\
        <span class="s2">"Expected: </span><span class="si">{}</span><span class="s2"> Actual: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
</pre></div>
<pre class="example">
0.67
0.24
0.09
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/nano/introduction-to-neural-networks/non-linear-regions/index.html">Non-Linear Regions</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/nano/introduction-to-neural-networks/non-linear-regions/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-22T22:19:29-07:00" itemprop="datePublished" title="2018-10-22 22:19">2018-10-22 22:19</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/nano/introduction-to-neural-networks/non-linear-regions/index.html#org1f58366">What's this about?</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/non-linear-regions/index.html#orga1eedc5">Continuous vs Discrete</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/non-linear-regions/index.html#org64c7eca">Gradent Descent</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/non-linear-regions/index.html#org480aa52">Discrete Vs Continuous Again (The Sigmoid)</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/non-linear-regions/index.html#org36e0181">Question</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org1f58366">
<h2 id="org1f58366">What's this about?</h2>
<div class="outline-text-2" id="text-org1f58366">
<p>The perceptron seems to work fairly well with our admissions problem, but that's because our data is seperable with a straight line. What if we need a curved line? This should also work, the secret sauce is how we define our error function.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orga1eedc5">
<h2 id="orga1eedc5">Continuous vs Discrete</h2>
<div class="outline-text-2" id="text-orga1eedc5">
<p>It turns out that if your values are discrete (rather than continuous) you might have a very difficult time tuning the algorithm, because our learning rate will keep it vascillating between solutions, so for this to work, we need a continuous solution space.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org64c7eca">
<h2 id="org64c7eca">Gradent Descent</h2>
<div class="outline-text-2" id="text-org64c7eca">
<p>Using descending a mountain as a metaphor, our goal is to look around and find the path that will take us the furthest down the mountain. In mathematical terms this means searching in the space adjacent to where we are and finding the solution that gives us the greatest reduction in error.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org480aa52">
<h2 id="org480aa52">Discrete Vs Continuous Again (The Sigmoid)</h2>
<div class="outline-text-2" id="text-org480aa52">
<p>Our categorizations are discrete, but our model doesn't work for discrete valuesâ€¦ how do we reconcile this? The trick is to use continuous values and then, instead of using the stepwise function to classify the outcomes, we use the sigmoid function. This converts interpretation from a discrete 0 or 1 to a probability.</p>
<p>\[ \sigma(x) = \frac{1}{1 + e^{-x}} \]</p>
</div>
</div>
<div class="outline-2" id="outline-container-org36e0181">
<h2 id="org36e0181">Question</h2>
<div class="outline-text-2" id="text-org36e0181">
<p>The score is defined as \(4x_1 + 5x_2 - 9\), which of the following values has a 50% probability of being blue or red?</p>
</div>
<div class="outline-3" id="outline-container-orga6c155e">
<h3 id="orga6c155e">Imports</h3>
<div class="outline-text-3" id="text-orga6c155e"></div>
<div class="outline-4" id="outline-container-org12bbce7">
<h4 id="org12bbce7">python standard library</h4>
<div class="outline-text-4" id="text-org12bbce7">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">probability</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">9</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">probability</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
</pre></div>
<pre class="example">
[1, 1]: 0.5
[2, 4]: 0.9999999943972036
[5, -5]: 8.315280276641321e-07
[-4, 5]: 0.5
</pre></div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html">The Perceptron Algorithm</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-20T17:53:27-07:00" itemprop="datePublished" title="2018-10-20 17:53">2018-10-20 17:53</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html#orgfc0418b">The Algorithm</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html#org0520536">Imports</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html#org95775e9">Setup</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html#org4d8ee04">The Data</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html#orgdad616d">The Implementation</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html#orge202721">The Perceptron</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/index.html#org3ce5082">Train the Perceptron Algorithm</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgfc0418b">
<h2 id="orgfc0418b">The Algorithm</h2>
<div class="outline-text-2" id="text-orgfc0418b">
<ol class="org-ol">
<li>Start with random weights. \(Wb\)</li>
<li>Test the weights and for every misclassified point:
<ul class="org-ul">
<li>create a vector with the coordinates of the point and append a 1 to it</li>
<li>multiply the vector by the learning rate</li>
<li>If the prediction was 0, add the vector to the weights</li>
<li>If the prediction was 1, subtract the vector from the weights</li>
</ul>
</li>
<li>Stop when the stopping condition has been reached:
<ul class="org-ul">
<li>no misclassified points</li>
<li>few enough misclassified points</li>
<li>you've run long enough</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="outline-2" id="outline-container-org0520536">
<h2 id="org0520536">Imports</h2>
<div class="outline-text-2" id="text-org0520536"></div>
<div class="outline-3" id="outline-container-org26f8037">
<h3 id="org26f8037">From PyPi</h3>
<div class="outline-text-3" id="text-org26f8037">
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org84c449c">
<h3 id="org84c449c">This Project</h3>
<div class="outline-text-3" id="text-org84c449c">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">neurotic.tangles.data_paths</span> <span class="kn">import</span> <span class="n">DataPath</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org95775e9">
<h2 id="org95775e9">Setup</h2>
<div class="outline-text-2" id="text-org95775e9"></div>
<div class="outline-3" id="outline-container-orga9b3d6c">
<h3 id="orga9b3d6c">The Plotting</h3>
<div class="outline-text-3" id="text-orga9b3d6c">
<div class="highlight">
<pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">"whitegrid"</span><span class="p">)</span>
<span class="n">FIGURE_SIZE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org4d8ee04">
<h2 id="org4d8ee04">The Data</h2>
<div class="outline-text-2" id="text-org4d8ee04">
<div class="highlight">
<pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">DataPath</span><span class="p">(</span><span class="s2">"admissions.csv"</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">from_folder</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
<p>I added the labels to match the earlier admissions problem, there aren't any in the actual data set.</p>
<p>Here is a plot of what we need to train our Perceptron on to create a linear classifier.</p>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FIGURE_SIZE</span><span class="p">)</span>
<span class="n">accepted</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Label</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">rejected</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Label</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Admissions Data"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Grades"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Test"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">accepted</span><span class="o">.</span><span class="n">Grades</span><span class="p">,</span> <span class="n">accepted</span><span class="o">.</span><span class="n">Test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Accepted"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rejected</span><span class="o">.</span><span class="n">Grades</span><span class="p">,</span> <span class="n">rejected</span><span class="o">.</span><span class="n">Test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Rejected"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgdad616d">
<h2 id="orgdad616d">The Implementation</h2>
<div class="outline-text-2" id="text-orgdad616d"></div>
<div class="outline-3" id="outline-container-org79e20dd">
<h3 id="org79e20dd">Set the random seed so the outcome is reproducible</h3>
<div class="outline-text-3" id="text-org79e20dd">
<div class="highlight">
<pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org2d68be4">
<h3 id="org2d68be4">The Step Function</h3>
<div class="outline-text-3" id="text-org2d68be4">
<p>This is the stepwise function that decides if the output is a 1 or a 0.</p>
<p>\[ \hat{y} = \begin{cases} 1 \text{ if } Wx + b \geq 0\\ 0 \text{ if } Wx + b \lt 0 \end{cases} \]</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">stepwise</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""A function to convert the value to a label</span>

<span class="sd">    Args:</span>
<span class="sd">     value: number to evaluate</span>

<span class="sd">    Returns:</span>
<span class="sd">     label: 0 or 1 based on the value</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Stepwise Function"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">stepwise</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
<div class="figure" id="orge4abd3e">
<p><img alt="stepwise.png" src="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/stepwise.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org8fdb528">
<h3 id="org8fdb528">The Prediction</h3>
<div class="outline-text-3" id="text-org8fdb528">
<p>\[ Wx + b = 0\\ \]</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">prediction</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Predicts whether X is 0 or 1</span>

<span class="sd">    Args:</span>
<span class="sd">     X: matrix of inputs</span>
<span class="sd">     W: weights</span>
<span class="sd">     b: bias</span>

<span class="sd">    Returns:</span>
<span class="sd">     label: 0 or 1</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">stepwise</span><span class="p">((</span><span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org744a4f1">
<h3 id="org744a4f1">The Perceptron Step</h3>
<div class="outline-text-3" id="text-org744a4f1">
<p>This is where the <i>Perceptron Trick</i> as described in the algorithm above is implemented.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">perceptron_step</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Adjusts the weights using the Perceptron Trick</span>

<span class="sd">    Args:</span>
<span class="sd">     X: the input data - array of rows with two columns</span>
<span class="sd">     y: the labels - array with one row of length matching the rows in X</span>
<span class="sd">     W: the weights - array of shape (2, 1)</span>
<span class="sd">     b: the bias - scalar</span>
<span class="sd">     learn_rate: how much to adjust the weights at each step</span>

<span class="sd">    Returns:</span>
<span class="sd">     W,b: the new weights and bias</span>
<span class="sd">    """</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">predicted</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">row</span><span class="p">],</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">row</span><span class="p">]</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">actual</span> <span class="o">-</span> <span class="n">predicted</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">W</span> <span class="o">+</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">W</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">learn_rate</span>
    <span class="k">return</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orge202721">
<h2 id="orge202721">The Perceptron</h2>
<div class="outline-text-2" id="text-orge202721">
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Perceptron</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""A perceptron to classify points</span>

<span class="sd">    Args:</span>
<span class="sd">     x_train: training data</span>
<span class="sd">     y_train: labels for the tranining data</span>
<span class="sd">     learnining_rate: how fast to update during training</span>
<span class="sd">     epochs: how many times to run the training</span>
<span class="sd">     verbosity: level of output</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_train</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
                 <span class="n">learning_rate</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                 <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="n">epochs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="n">verbosity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weights</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bias</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_training_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">training_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""the training data as a DataFrame"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_training_data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_train</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Vector of weights for the predictions"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weights</span>

    <span class="nd">@weights</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights_prime</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Update the weight</span>

<span class="sd">       Args:</span>
<span class="sd">        weights: new weights for the prediction calculations</span>
<span class="sd">       """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weights</span> <span class="o">=</span> <span class="n">weights_prime</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bias</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""The bias constant"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bias</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bias</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_train</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bias</span>

    <span class="nd">@bias</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">bias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bias_prime</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Sets the bias for predictions"""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bias</span> <span class="o">=</span> <span class="n">bias_prime</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""For the two-dimensional case, gives the y-value </span>

<span class="sd">       Returns:</span>
<span class="sd">        the y-value for the separator line</span>
<span class="sd">       """</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""makes a prediction for a single point</span>

<span class="sd">       Args:</span>
<span class="sd">        instance: data to make a prediction for</span>

<span class="sd">       Returns:</span>
<span class="sd">        prediction: a 0 or 1</span>
<span class="sd">       """</span>
        <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">take_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""takes a single training step"""</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_train</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
            <span class="n">actual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">[</span><span class="n">row</span><span class="p">]</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="n">actual</span> <span class="o">-</span> <span class="n">predicted</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">T</span>
                            <span class="o">+</span> <span class="n">direction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_train</span><span class="p">[</span><span class="n">row</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">+</span> <span class="n">direction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Predicted: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">predicted</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Actual: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">actual</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Direction: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">direction</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Weights: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Bias: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Trains the perceptron"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Starting Training"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">take_step</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Epoch: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Accuracy: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accuracy</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">accuracy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""What fraction of data will our current weights classify correctly"""</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">row</span><span class="p">),</span>
                                               <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">predictions</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">correct</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org3ce5082">
<h2 id="org3ce5082">Train the Perceptron Algorithm</h2>
<div class="outline-text-2" id="text-org3ce5082">
<p>This function runs the perceptron algorithm repeatedly on the dataset, and returns a few of the boundary lines obtained in the iterations for plotting purposes.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">trainPerceptronAlgorithm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">25</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Trains the Perceptron</span>

<span class="sd">    Args:</span>
<span class="sd">     X: array of row-data with two-columns</span>
<span class="sd">     y: array with labels for the row-data</span>
<span class="sd">     learn_rate: how much to change the weights based on each data-point</span>
<span class="sd">     num_epochs: how many times to re-train the perceptron</span>
<span class="sd">    """</span>
    <span class="n">x_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_max</span>
    <span class="c1"># These are the solution lines that get plotted below.</span>
    <span class="n">boundary_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
        <span class="c1"># In each epoch, we apply the perceptron step.</span>
        <span class="n">W</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">perceptron_step</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">learn_rate</span><span class="p">)</span>
        <span class="n">boundary_lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">W</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">W</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">b</span><span class="o">/</span><span class="n">W</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">boundary_lines</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-org965cf7b">
<h3 id="org965cf7b">A Better Training</h3>
<div class="outline-text-3" id="text-org965cf7b">
<p>For some reason Udacity decided that giving "Try Again" as the only feedback when submitting this thing was a good ideaâ€¦ so I guess I'll have to do this myself. They seem to have made their stuff look much nicer than it used to, but they're still kind of tone-deaf when designing the way they structure their assignments sometimes.</p>
<div class="highlight">
<pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">"Test"</span><span class="p">,</span> <span class="s2">"Grades"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">values</span>
<span class="n">perceptron</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">)</span>
<span class="n">perceptron</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Accuracy after </span><span class="si">{}</span><span class="s2"> epochs: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">perceptron</span><span class="o">.</span><span class="n">accuracy</span><span class="p">))</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">perceptron</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">perceptron</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Accuracy after </span><span class="si">{}</span><span class="s2"> epochs: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">perceptron</span><span class="o">.</span><span class="n">accuracy</span><span class="p">))</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FIGURE_SIZE</span><span class="p">)</span>
<span class="n">accepted</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Label</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">rejected</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">Label</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">LIMITS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">LIMITS</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">LIMITS</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Perceptron Model After </span><span class="si">{}</span><span class="s2"> Epochs"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epochs</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">accepted</span><span class="o">.</span><span class="n">Test</span><span class="p">,</span> <span class="n">accepted</span><span class="o">.</span><span class="n">Grades</span><span class="p">,</span> <span class="s1">'ro'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Accepted"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rejected</span><span class="o">.</span><span class="n">Test</span><span class="p">,</span> <span class="n">rejected</span><span class="o">.</span><span class="n">Grades</span><span class="p">,</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Rejected"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">perceptron</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="orgc27ad99">
<p><img alt="model_separation.png" src="posts/nano/introduction-to-neural-networks/the-perceptron-algorithm/model_separation.png"></p>
</div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/nano/introduction-to-neural-networks/perceptrons/index.html">Perceptrons</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/nano/introduction-to-neural-networks/perceptrons/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-20T17:43:47-07:00" itemprop="datePublished" title="2018-10-20 17:43">2018-10-20 17:43</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/nano/introduction-to-neural-networks/perceptrons/index.html#orga26d5d7">Imports</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/perceptrons/index.html#orgdeb818e">Setup the Plotting</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/perceptrons/index.html#org4cae1ec">What is a Perceptron?</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/perceptrons/index.html#org941572f">Why are these called neural networks?</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/perceptrons/index.html#orga743d83">Can perceptrons do logic?</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/perceptrons/index.html#org088fdea">That's a lot of work to get an XOR, how are we going to classify images like this?</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orga26d5d7">
<h2 id="orga26d5d7">Imports</h2>
<div class="outline-text-2" id="text-orga26d5d7"></div>
<div class="outline-3" id="outline-container-org1191936">
<h3 id="org1191936">From PyPi</h3>
<div class="outline-text-3" id="text-org1191936">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgdeb818e">
<h2 id="orgdeb818e">Setup the Plotting</h2>
<div class="outline-text-2" id="text-orgdeb818e">
<div class="highlight">
<pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">"whitegrid"</span><span class="p">)</span>
<span class="n">FIGURE_SIZE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org4cae1ec">
<h2 id="org4cae1ec">What is a Perceptron?</h2>
<div class="outline-text-2" id="text-org4cae1ec">
<p>A perceptron is a model based on the neuron that works as a linear classifier.</p>
<p>Our acceptance model from the previous post:</p>
<p>\[ 2x_1 + x_2 - 18 = 0 \]</p>
<p>Would be modeled by something like this.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Perceptron"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s2">"rankdir"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"Test"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"Grade"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"-18"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"Label"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"2"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/perceptron.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org7b936cd">
<p><img alt="perceptron.dot.png" src="posts/nano/introduction-to-neural-networks/perceptrons/perceptron.dot.png"></p>
</div>
<p>Where the weights on the edges of the graph are multiplied by the values from the input nodes and then added together with -18. The constant we add at the end is called a <i>bias</i> value, and an alternative way to notate it is to add an input node for it that always has a value of 1 for the input and -18 for the edge. This is equivalent to the previous graph but makes it a little more consistent.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Perceptron 2"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s2">"rankdir"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"Test"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"Grade"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"Bias=1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"+"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"Label"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"2"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"e"</span> <span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"-18"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/perceptron_2.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="orge6f8cc3">
<p><img alt="perceptron_2.dot.png" src="posts/nano/introduction-to-neural-networks/perceptrons/perceptron_2.dot.png"></p>
</div>
<p>We can re-draw the graph to make it more explicit that there is a separate step-wise function to convert the score to a label, as well as use the more general notation of <i>x</i> and <i>w</i>.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Perceptron 3"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s2">"rankdir"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"Test"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"Grade"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"Bias=1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"+"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"Step Function"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"f"</span><span class="p">,</span> <span class="s2">"Label"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"2"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"e"</span> <span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"-18"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"f"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/perceptron_3.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org9d350ff">
<p><img alt="perceptron_3.dot.png" src="posts/nano/introduction-to-neural-networks/perceptrons/perceptron_3.dot.png"></p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org941572f">
<h2 id="org941572f">Why are these called neural networks?</h2>
<div class="outline-text-2" id="text-org941572f">
<p>The perceptron is modeled on a neuron in the brain which takes signal inputs and decides to fire (or not) based on these inputs.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orga743d83">
<h2 id="orga743d83">Can perceptrons do logic?</h2>
<div class="outline-text-2" id="text-orga743d83"></div>
<div class="outline-3" id="outline-container-org1df9820">
<h3 id="org1df9820">The AND operator</h3>
<div class="outline-text-3" id="text-org1df9820">
<p>Here's the truth table for the And operator.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>So how would you make a perceptron for this? Remember that the perceptron is a linear separator, so if you think if the two inputs as axes on the plane, you would fit a line that separates the outputs of 0 from the output of 1.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org9951e5a">
<h3 id="org9951e5a">A Perceptron Class</h3>
<div class="outline-text-3" id="text-org9951e5a">
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Perceptron</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Simple single perceptron</span>

<span class="sd">    Args:</span>
<span class="sd">     weight_x: weight for input x values</span>
<span class="sd">     weight_y: weight for input y values (x2)</span>
<span class="sd">     bias: bias scalar</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weight_x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">weight_y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">bias</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_x</span> <span class="o">=</span> <span class="n">weight_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_y</span> <span class="o">=</span> <span class="n">weight_y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""calculate score for the inputs</span>

<span class="sd">       Args:</span>
<span class="sd">        x, y: inputs to the linear equation</span>

<span class="sd">       Returns:</span>
<span class="sd">        score: value representing which side of the line the point is</span>
<span class="sd">       """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>

    <span class="k">def</span> <span class="nf">separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""generates the values for the separation line</span>

<span class="sd">       Args: </span>
<span class="sd">        x: the input value to generate the y-value for</span>

<span class="sd">       Returns:</span>
<span class="sd">        y: value for the plot given x</span>
<span class="sd">       """</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_y</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Updates the weights</span>

<span class="sd">       Args:</span>
<span class="sd">        weights: array of new weights (including bias)</span>
<span class="sd">       """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_x</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_y</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""converts the score to a label</span>

<span class="sd">       This is the stepwise function</span>

<span class="sd">       Args:</span>
<span class="sd">        x, y: point values to check </span>

<span class="sd">       Returns:</span>
<span class="sd">        label: 1 if right of the line, 0 otherwize</span>
<span class="sd">       """</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgb869e69">
<h3 id="orgb869e69">A Truth Table Printer</h3>
<div class="outline-text-3" id="text-orgb869e69">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">truth_table</span><span class="p">(</span><span class="n">perceptron</span><span class="p">):</span>
    <span class="n">binary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"|Input 1|Input 2| Label|"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"|-+-+-|"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">input_1</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">input_2</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">perceptron</span><span class="p">(</span><span class="n">input_1</span><span class="p">,</span> <span class="n">input_2</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">"|</span><span class="si">{}</span><span class="s2">|</span><span class="si">{}</span><span class="s2">|</span><span class="si">{}</span><span class="s2">|"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">input_1</span><span class="p">,</span> <span class="n">input_2</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>
    <span class="k">return</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">perceptron_and</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weight_x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
<p>So now here's the perceptron's truth table.</p>
<div class="highlight">
<pre><span></span><span class="n">truth_table</span><span class="p">(</span><span class="n">perceptron_and</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not AND"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron_and</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">perceptron_and</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)],</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"AND"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Logical AND"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="orgbb32204">
<p><img alt="perceptron_and.png" src="posts/nano/introduction-to-neural-networks/perceptrons/perceptron_and.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orga08a53c">
<h3 id="orga08a53c">Perceptron OR</h3>
<div class="outline-text-3" id="text-orga08a53c">
<p>A similar thing can be done for the OR operator.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">perceptron_or</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weight_x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
<p>And once again I'll check that the perceptron can replicate the truth table.</p>
<div class="highlight">
<pre><span></span><span class="n">truth_table</span><span class="p">(</span><span class="n">perceptron_or</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not OR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron_or</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
                       <span class="n">perceptron_or</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)],</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"OR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Logical OR"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="orgab19bb8">
<p><img alt="perceptron_or.png" src="posts/nano/introduction-to-neural-networks/perceptrons/perceptron_or.png"></p>
</div>
<p>If you look at the plot you can see that the separator has to move lower, so, somewhat unintuitively your intercept (bias) should be less negative.</p>
<p>Or you should give more weight to the inputs.</p>
<div class="highlight">
<pre><span></span><span class="n">perceptron_or_2</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weight_x</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
<p>And here's the table generated with the same bias as the AND perceptron but with heavier weights.</p>
<div class="highlight">
<pre><span></span><span class="n">truth_table</span><span class="p">(</span><span class="n">perceptron_or_2</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not OR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron_or_2</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">),</span>
                       <span class="n">perceptron_or_2</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)],</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"OR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Logical OR"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="org6391bb1">
<p><img alt="perceptron_or_2.png" src="posts/nano/introduction-to-neural-networks/perceptrons/perceptron_or_2.png"></p>
</div>
<p>Seems to work okay.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org42e357d">
<h3 id="org42e357d">NOT</h3>
<div class="outline-text-3" id="text-org42e357d">
<p>The NOT operation only looks at one input. To re-use our perceptron we can set the weights so it ignores the first input and negates the second.</p>
<p>Here's the Truth Table for NOT.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">X</th>
<th class="org-right" scope="col">NOT</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>So now we create a perceptron with an x-weight of 0.</p>
<div class="highlight">
<pre><span></span><span class="n">perceptron_not</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weight_x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">weight_y</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
<p>And see the output.</p>
<div class="highlight">
<pre><span></span><span class="n">truth_table</span><span class="p">(</span><span class="n">perceptron_not</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>The table is overkill, since we only need to test two outputs, but it shows that even with the same inputs as the other perceptrons it can negate the second input.</p>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"False"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"True"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="n">perceptron_not</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">),</span> 
                      <span class="n">perceptron_not</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)],</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Logical NOT"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="org8becf81">
<p><img alt="perceptron_not.png" src="posts/nano/introduction-to-neural-networks/perceptrons/perceptron_not.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org1561565">
<h3 id="org1561565">What about the XOR?</h3>
<div class="outline-text-3" id="text-org1561565">
<p>The XOR operator only returns True if one or the other input is True, not if both are True.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">XOR</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">"ro"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">"bo"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not XOR"</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="org70ae5de">
<p><img alt="perceptron_xor.png" src="posts/nano/introduction-to-neural-networks/perceptrons/perceptron_xor.png"></p>
</div>
<p>If you look at the plot you can see that a single straight line won't separate the blue and the red dots. The solution turns out to add a layers of perceptrons to make it work.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Multilayer Perceptron"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s1">'rankdir'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"A"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"f"</span><span class="p">,</span> <span class="s2">"AND"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"g"</span><span class="p">,</span> <span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">([</span><span class="s2">"ac"</span><span class="p">,</span> <span class="s2">"ad"</span><span class="p">,</span> <span class="s1">'bc'</span><span class="p">,</span> <span class="s1">'bd'</span><span class="p">,</span> <span class="s1">'ce'</span><span class="p">,</span> <span class="s1">'ef'</span><span class="p">,</span> <span class="s1">'df'</span><span class="p">,</span> <span class="s1">'fg'</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/multilayer_perceptron.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org6fc2651">
<p><img alt="multilayer_perceptron.dot.png" src="posts/nano/introduction-to-neural-networks/perceptrons/multilayer_perceptron.dot.png"></p>
</div>
<p>A, B, and C are OR, NOT and AND perceptrons, the key is to figure out which is which. The trick is to notice that AND is True when both are true, so we want B to to be 1 everytime there is at least one True and C to negate the one case when they're both True. So B is an OR, C is NOT and A is an AND (because and is True only when they're both True and C negates it).</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Multilayer Perceptron"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s1">'rankdir'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"AND 1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"OR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"NOT"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"f"</span><span class="p">,</span> <span class="s2">"AND 2"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"g"</span><span class="p">,</span> <span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">([</span><span class="s2">"ac"</span><span class="p">,</span> <span class="s2">"ad"</span><span class="p">,</span> <span class="s1">'bc'</span><span class="p">,</span> <span class="s1">'bd'</span><span class="p">,</span> <span class="s1">'ce'</span><span class="p">,</span> <span class="s1">'ef'</span><span class="p">,</span> <span class="s1">'df'</span><span class="p">,</span> <span class="s1">'fg'</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/multilayer_perceptron_2.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="orga41847f">
<p><img alt="multilayer_perceptron_2.dot.png" src="posts/nano/introduction-to-neural-networks/perceptrons/multilayer_perceptron_2.dot.png"></p>
</div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">AND 1</th>
<th class="org-right" scope="col">NOT</th>
<th class="org-right" scope="col">OR</th>
<th class="org-right" scope="col">AND 2</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>It's not the clearest table, but <i>AND 1</i> and <i>OR</i> both take the original inputs, then <i>NOT</i> negates <i>AND 1</i> and the output of <i>NOT</i> and <i>OR</i> feed into <i>AND 2</i> which puts out our exclusive or.</p>
<p>Here's what happens when we use the perceptrons we created earlier to generate the same table.</p>
<div class="highlight">
<pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"| Input 1 | Input 2 | AND 1 | NOT | OR | XOR |"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"|---------+---------+-------+-----+----+-------|"</span><span class="p">)</span>
<span class="n">row</span> <span class="o">=</span> <span class="s2">"|"</span> <span class="o">+</span> <span class="s2">"</span><span class="si">{}</span><span class="s2">|"</span> <span class="o">*</span> <span class="mi">6</span>
<span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
    <span class="n">and_1</span> <span class="o">=</span> <span class="n">perceptron_and</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">nand</span> <span class="o">=</span> <span class="n">perceptron_not</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">and_1</span><span class="p">)</span>
    <span class="n">or_1</span> <span class="o">=</span> <span class="n">perceptron_or</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">xor</span> <span class="o">=</span> <span class="n">perceptron_and</span><span class="p">(</span><span class="n">nand</span><span class="p">,</span> <span class="n">or_1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">and_1</span><span class="p">,</span> <span class="n">nand</span><span class="p">,</span> <span class="n">or_1</span><span class="p">,</span> <span class="n">xor</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Input 1</th>
<th class="org-right" scope="col">Input 2</th>
<th class="org-right" scope="col">AND 1</th>
<th class="org-right" scope="col">NOT</th>
<th class="org-right" scope="col">OR</th>
<th class="org-right" scope="col">XOR</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>Looks right.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org22a3f58">
<h3 id="org22a3f58">Nand</h3>
<div class="outline-text-3" id="text-org22a3f58">
<p>that the combination or AND and NOT is a NAND operator so you could simplify the diagram a little back to just two layers.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Two-Layer XOR Perceptron"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="s1">'rankdir'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"LR"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"NAND"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"d"</span><span class="p">,</span> <span class="s2">"OR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"f"</span><span class="p">,</span> <span class="s2">"AND"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"g"</span><span class="p">,</span> <span class="s2">"XOR"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">([</span><span class="s2">"ac"</span><span class="p">,</span> <span class="s2">"ad"</span><span class="p">,</span> <span class="s1">'bc'</span><span class="p">,</span> <span class="s1">'bd'</span><span class="p">,</span> <span class="s2">"cf"</span><span class="p">,</span> <span class="s1">'df'</span><span class="p">,</span> <span class="s1">'fg'</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"graphs/two_layer_xor.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org581949c">
<p><img alt="two_layer_xor.dot.png" src="posts/nano/introduction-to-neural-networks/perceptrons/two_layer_xor.dot.png"></p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org088fdea">
<h2 id="org088fdea">That's a lot of work to get an XOR, how are we going to classify images like this?</h2>
<div class="outline-text-2" id="text-org088fdea">
<p>This isn't about image classification, but we probably should note that you normally wouldn't try and figure out the parameters by hand, the perceptron can tune itself. The way it does this is by picking some initial random values and then it repeatedly tests how well it did and adjusts the weights.</p>
</div>
<div class="outline-3" id="outline-container-org4e291fe">
<h3 id="org4e291fe">How does it adjust the weights?</h3>
<div class="outline-text-3" id="text-org4e291fe">
<p>This is what's called "the Perceptron Trick". It basically forms a vector for each of the misclassified points \((x_1, x_2, 1)\) and subtracts it from the weights \((w_1, w_2, b)\) if the score was on the positive side and adds to it if the score was on the negative side. It then repeats this for each of the misclassified points. Since we have multiple points we don't want it to just make these huge jumps, so the misclassified points vector is multiplied by some fraction (called the <i>learning rate</i>) so that the changes are small. Once it has the new weights it then tests itself again and makes another adjustment.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org1880831">
<h3 id="org1880831">Question</h3>
<div class="outline-text-3" id="text-org1880831">
<p>If the original line was \(3x_1 + 4x_2 - 10 = 0\), and the learning rate was set to 0.1, how many adjustments would you have to make to reach the point (1, 1)?</p>
<div class="highlight">
<pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">adjustment</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">learning_rate</span>
<span class="n">output</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">adjustments</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">perceptron</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">perceptron</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">adjustments</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">output</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">+</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">adjustment</span>
    <span class="n">perceptron</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Final Output: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">print</span><span class="p">(</span><span class="s2">"Adjustments: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adjustments</span><span class="p">)))</span>
</pre></div>
<pre class="example" id="org6297a14">
-3
-2.700000000000001
-2.4000000000000012
-2.1000000000000014
-1.8000000000000025
-1.5000000000000036
-1.2000000000000028
-0.9000000000000039
-0.600000000000005
-0.30000000000000604
-7.105427357601002e-15
Final Output: 0.29999999999999183
Adjustments: 11
None
</pre>
<p>I came up with 11 adjustments but Udacity says 10â€¦ Close enough, I guess.</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html">Introduction to Neural Networks</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-20T12:38:59-07:00" itemprop="datePublished" title="2018-10-20 12:38">2018-10-20 12:38</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html#orgf8d3c84">Imports</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html#org5af93fb">Some Types</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html#org9db019c">Introduction</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html#orgf7091b9">What are Neural Networks</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html#org13f2f38">Classification Problems</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html#orgbb61ef0">Linear Boundaries</a></li>
<li><a href="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/index.html#org1cb0af6">What about more variables?</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgf8d3c84">
<h2 id="orgf8d3c84">Imports</h2>
<div class="outline-text-2" id="text-orgf8d3c84"></div>
<div class="outline-3" id="outline-container-org2c9da1a">
<h3 id="org2c9da1a">From ipython</h3>
<div class="outline-text-3" id="text-org2c9da1a">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org1bbc32b">
<h3 id="org1bbc32b">From Pypi</h3>
<div class="outline-text-3" id="text-org1bbc32b">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org21e08b8">
<h3 id="org21e08b8">This Project</h3>
<div class="outline-text-3" id="text-org21e08b8">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">neurotic.tangles.data_paths</span> <span class="kn">import</span> <span class="n">DataPath</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org60f2023">
<h3 id="org60f2023">Setup the Plotting</h3>
<div class="outline-text-3" id="text-org60f2023">
<div class="highlight">
<pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">"whitegrid"</span><span class="p">)</span>
<span class="n">FIGURE_SIZE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org5af93fb">
<h2 id="org5af93fb">Some Types</h2>
<div class="outline-text-2" id="text-org5af93fb">
<div class="highlight">
<pre><span></span><span class="n">Identifier</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org9db019c">
<h2 id="org9db019c">Introduction</h2>
<div class="outline-text-2" id="text-org9db019c">
<p>These are notes on the series <i>Introduction to Neural Networks</i> taught by <a href="https://medium.com/@luis.serrano">Luis Serrano</a> as part of Udacity's Deep Learning Nan Degree.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgf7091b9">
<h2 id="orgf7091b9">What are Neural Networks</h2>
<div class="outline-text-2" id="text-orgf7091b9">
<p>Neural Networks are algorithms loosely based on the neurons in the brain. Although biologically inspired, in many ways what they do can be viewed as linear separation. But as the complexity of the network builds, this simple idea can produce outcomes that look much more complicated.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org13f2f38">
<h2 id="org13f2f38">Classification Problems</h2>
<div class="outline-text-2" id="text-org13f2f38"></div>
<div class="outline-3" id="outline-container-org8855aa4">
<h3 id="org8855aa4">Example: College Admissions</h3>
<div class="outline-text-3" id="text-org8855aa4">
<p>You have a set of test scores and grades for students who applied to a university, as well as whether they were accepted or rejected. For example:</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Student</th>
<th class="org-left" scope="col">Test</th>
<th class="org-left" scope="col">Grades</th>
<th class="org-left" scope="col">Accepted</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">9/10</td>
<td class="org-left">8/10</td>
<td class="org-left">Yes</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-left">3/10</td>
<td class="org-left">4/10</td>
<td class="org-left">No</td>
</tr>
</tbody>
</table>
<p>You have a new student 3 and you're wondering if he will likely get accepted.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Student</th>
<th class="org-left" scope="col">Test</th>
<th class="org-left" scope="col">Grades</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">3</td>
<td class="org-left">7/10</td>
<td class="org-left">6/10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgbb61ef0">
<h2 id="orgbb61ef0">Linear Boundaries</h2>
<div class="outline-text-2" id="text-orgbb61ef0">
<p>We're going to make our prediction using a linear classifier that decides if the student is above or below a line that separates the accepted and rejected students. A <i>boundary line</i> is defined by inputs (<i>x</i>), weights (<i>w</i>), and an intercept (<i>b</i>). For the two-dimensional case the equation would be this.</p>
<p>\[ w_1 x_1 + w_2 x_2 + b = 0 \]</p>
<p>For our example the boundary line turns out to be:</p>
<p>\[ 2x_1 + x_2 - 18 = 0 \]</p>
<p>or to use our naming scheme.</p>
<p>\[ 2 \times \textit{Test} + \textit{Grades} - 18 = \textit{Score} \]</p>
<p>Once we have the score our prediction will be based on the sign of the score. If it is positive we will predict an acceptance and if it is negative, we will predict a rejection. If a student has a score if 0 that means he or she is on the line, so to make it a binary classification we will say that we will accept the student if the score is zero as well.</p>
</div>
<div class="outline-3" id="outline-container-orgb5ecc54">
<h3 id="orgb5ecc54">A More Formal Version</h3>
<div class="outline-text-3" id="text-orgb5ecc54">
<p>Our equation for our line is composed of two vectors that output a number which we will label either 1 (accepted) or 0 (rejected) based on the output.</p>
<p>Our original equation:</p>
<p>\[ w_x x_1 + w_2 x_2 + b = 0 \]</p>
<p>Can be re-written using vectors.</p>
<p>\[ Wx + b = 0\\ W = (w_1, w_2)\\ x = (x_1, x_2)\\ \]</p>
<p>And our labels for the outcomes are in this set. \[ y \in \{0, 1\}\\ \]</p>
<p>Our prediction is a stepwise function that we hope will match the true label.</p>
<p>\[ \hat{y} = \begin{cases} 1 \text{ if } Wx + b \geq 0\\ 0 \text{ if } Wx + b \lt 0 \end{cases} \]</p>
</div>
</div>
<div class="outline-3" id="outline-container-org85d758a">
<h3 id="org85d758a">What would our score be for Student 3?</h3>
<div class="outline-text-3" id="text-org85d758a">
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Student</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Holds the student's info</span>

<span class="sd">    Args:</span>
<span class="sd">     name: identifier for the student</span>
<span class="sd">     test: score on the test</span>
<span class="sd">     grades: student's grade value (average?)</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">grades</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test</span> <span class="o">=</span> <span class="n">test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grades</span> <span class="o">=</span> <span class="n">grades</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""something to identify the student"""</span>
        <span class="k">return</span> <span class="s2">"Student </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">Score</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Calculate the score for our student</span>

<span class="sd">    Args:</span>
<span class="sd">     student: a Student</span>
<span class="sd">     test_weight: the weight for the test score     </span>
<span class="sd">     bias: the bias value</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">student</span><span class="p">:</span> <span class="n">Student</span><span class="p">,</span>
                 <span class="n">test_weight</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="p">:</span> <span class="nb">float</span><span class="o">=-</span><span class="mi">18</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">student</span> <span class="o">=</span> <span class="n">student</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_weight</span> <span class="o">=</span> <span class="n">test_weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_score</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""The calculated score for the student"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_score</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_weight</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">student</span><span class="o">.</span><span class="n">test</span>
                           <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">student</span><span class="o">.</span><span class="n">grades</span>
                           <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""A classification for this score (0|1)"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""whether the student was accepted or rejected"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span> <span class="o">=</span> <span class="s2">"Accepted"</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">"Rejected"</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outcome</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Pretty printed outcomes (an org-table)"""</span>
        <span class="n">output</span> <span class="o">=</span>  <span class="s2">"||Value|</span><span class="se">\n</span><span class="s2">"</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">"|-+-|</span><span class="se">\n</span><span class="s2">"</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">"|Score|</span><span class="si">{:.2f}</span><span class="s2">|</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">"|Label|</span><span class="si">{}</span><span class="s2">|</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">"|Prediction|</span><span class="si">{}</span><span class="s2">|"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcome</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">student_3</span> <span class="o">=</span> <span class="n">Student</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">grades</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">Score</span><span class="p">(</span><span class="n">student_3</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">&nbsp;</th>
<th class="org-right" scope="col">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Score</td>
<td class="org-right">2.00</td>
</tr>
<tr>
<td class="org-left">Label</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Prediction</td>
<td class="org-right">Accepted</td>
</tr>
</tbody>
</table>
<p>He got a positive score so we predict that he will get in.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org4c12921">
<h3 id="org4c12921">Plot the Separation</h3>
<div class="outline-text-3" id="text-org4c12921">
<p>To plot the separation we have to re-write our equation so the <i>y</i> (called <i>Grades</i>) is on one side of the equation.</p>
<p>\[ w_1 x_1 + w_2 x_2 + b = 0\\ w_2 x_2 = -w_1 x_1 - b\\ \textit{grade} = -2\textit{test} + 18\\ \]</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">separation</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">slope</span><span class="p">:</span> <span class="nb">float</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_intercept</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""gives the y-value for the separation line</span>

<span class="sd">    Args:</span>
<span class="sd">     x: input value</span>
<span class="sd">     slope: slope value</span>
<span class="sd">     y_intercept: y-intercept value</span>

<span class="sd">    Returns:</span>
<span class="sd">     y: value on the linear separation line</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y_intercept</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FIGURE_SIZE</span><span class="p">)</span>
<span class="n">limit</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">student_3</span><span class="p">))</span>
<span class="n">grades</span> <span class="o">=</span> <span class="p">[</span><span class="n">separation</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">separation</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">student_3</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">student_3</span><span class="o">.</span><span class="n">grades</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">student_3</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Test"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Grades"</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="n">grades</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="orgbbe9205">
<p><img alt="score_1.png" src="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/score_1.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgcd8cd33">
<h3 id="orgcd8cd33">If the test was weighted <i>1.5</i> instead of <i>2</i>, would our student still have gotten in?</h3>
<div class="outline-text-3" id="text-orgcd8cd33">
<div class="highlight">
<pre><span></span><span class="n">TEST_WEIGHT</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">Score</span><span class="p">(</span><span class="n">student_3</span><span class="p">,</span> <span class="n">test_weight</span><span class="o">=</span><span class="n">TEST_WEIGHT</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">&nbsp;</th>
<th class="org-right" scope="col">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Score</td>
<td class="org-right">-1.50</td>
</tr>
<tr>
<td class="org-left">Label</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">Prediction</td>
<td class="org-right">Rejected</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">SLOPE</span> <span class="o">=</span> <span class="o">-</span><span class="n">TEST_WEIGHT</span>
<span class="n">figure</span><span class="p">,</span> <span class="n">axe</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FIGURE_SIZE</span><span class="p">)</span>
<span class="n">limit</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"</span><span class="si">{}</span><span class="s2"> with Test Weight </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">student_3</span><span class="p">,</span> <span class="n">TEST_WEIGHT</span><span class="p">))</span>
<span class="n">grades</span> <span class="o">=</span> <span class="p">[</span><span class="n">separation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="n">SLOPE</span><span class="p">),</span> <span class="n">separation</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="n">SLOPE</span><span class="p">)]</span>
<span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">student_3</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">student_3</span><span class="o">.</span><span class="n">grades</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">student_3</span><span class="p">))</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Test"</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Grades"</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="n">grades</span><span class="p">)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<div class="figure" id="orgacc5bbd">
<p><img alt="score_2.png" src="posts/nano/introduction-to-neural-networks/introduction-to-neural-networks/score_2.png"></p>
</div>
<p>The student is to the left of the separation and so won't get in, as we found earlier.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org1cb0af6">
<h2 id="org1cb0af6">What about more variables?</h2>
<div class="outline-text-2" id="text-org1cb0af6">
<p>For every variable you add you add an extra dimension. So if you add one more variable, instead of a line our separator will be a plane.</p>
<p>\[ w_1 x_1 + w_2 x_2 + w_3 x_3 + b = 0 \]</p>
<p>But when you use vector notation it will look the same.</p>
<p>\[ Wx + b = 0 \hat{y} = \begin{cases} 1 \text{ if } Wx + b \geq 0\\ 0 \text{ if } Wx + b \lt 0 \end{cases} \]</p>
<p>This will be true no matter how many variable (dimensions) you add.</p>
</div>
<div class="outline-3" id="outline-container-orgeba1154">
<h3 id="orgeba1154">Question</h3>
<div class="outline-text-3" id="text-orgeba1154">
<p>You have a table with n columns representing features to evaluate students and each row is a student. What would be the shapes of the vectors?</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">W</th>
<th class="org-left" scope="col">x</th>
<th class="org-left" scope="col">b</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">1 x n</td>
<td class="org-left">n x 1</td>
<td class="org-left">1 x 1</td>
</tr>
</tbody>
</table>
<p>Our output is a single value, so the rows for weights and columns for inputs should be 1, and b is just a scalar.</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/nano/numpy-practice-one/index.html">NumPy Practice One</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/nano/numpy-practice-one/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-20T10:57:58-07:00" itemprop="datePublished" title="2018-10-20 10:57">2018-10-20 10:57</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div class="outline-2" id="outline-container-org0f6bebe">
<h2 id="org0f6bebe">Imports</h2>
<div class="outline-text-2" id="text-org0f6bebe">
<div class="highlight">
<pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org5413928">
<h2 id="org5413928">Prepare Inputs</h2>
<div class="outline-text-2" id="text-org5413928">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">prepare_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""transforms inputs and does some math</span>

<span class="sd">    Creates a 2-dimensional ndarray from the given 1-dimensional list</span>
<span class="sd">     and assigns  it to input_array</span>

<span class="sd">    Finds the minimum value in the input array and subtracts that</span>
<span class="sd">     value from all the elements of input_array.</span>

<span class="sd">    Finds the maximum value in inputs_minus_min and divides</span>
<span class="sd">     all of the values in inputs_minus_min by the maximum value.</span>

<span class="sd">    Args:</span>
<span class="sd">     inputs: one-dimensional list</span>

<span class="sd">    Returns:</span>
<span class="sd">     tuple: transposed inputs, inputs-minus-min, inputs-minus-min scaled by max</span>
<span class="sd">    """</span>
    <span class="n">input_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inputs</span><span class="p">])</span>
    <span class="n">inputs_minus_min</span> <span class="o">=</span> <span class="n">input_array</span> <span class="o">-</span> <span class="n">input_array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">inputs_div_max</span> <span class="o">=</span> <span class="n">inputs_minus_min</span><span class="o">/</span><span class="n">inputs_minus_min</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">input_array</span><span class="p">,</span> <span class="n">inputs_minus_min</span><span class="p">,</span> <span class="n">inputs_div_max</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">transposed</span><span class="p">,</span> <span class="n">less_min</span><span class="p">,</span> <span class="n">divided_by_max</span> <span class="o">=</span> <span class="n">prepare_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">transposed</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">expected</span> <span class="o">==</span> <span class="n">less_min</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">less_min</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">expected</span><span class="o">/</span><span class="mi">2</span> <span class="o">==</span> <span class="n">divided_by_max</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">divided_by_max</span><span class="p">)</span>
</pre></div>
<pre class="example">
[[1 2 3]]
[[0 1 2]]
[[0.  0.5 1. ]]
</pre></div>
</div>
<div class="outline-2" id="outline-container-org1dc2708">
<h2 id="org1dc2708">Multiply Inputs</h2>
<div class="outline-text-2" id="text-org1dc2708">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">multiply_inputs</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Multiplies matrices</span>

<span class="sd">    Args:</span>
<span class="sd">     m1, m2: matrices to multiply</span>

<span class="sd">    Returns:</span>
<span class="sd">     matrix product or False if shapes are wrong</span>
<span class="sd">    """</span>
    <span class="n">product</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">okay</span><span class="p">,</span> <span class="n">swap</span> <span class="o">=</span> <span class="n">m1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">m2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">m2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">okay</span><span class="p">,</span> <span class="n">swap</span><span class="p">)):</span>
        <span class="n">product</span> <span class="o">=</span> <span class="n">m1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span> <span class="k">if</span> <span class="n">okay</span> <span class="k">else</span> <span class="n">m2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">product</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">ROW</span><span class="p">,</span> <span class="n">COLUMN</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">m_1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">m_2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">m_3</span> <span class="o">=</span> <span class="n">m_2</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">m_4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m_3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{}</span><span class="s2"> x </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m_1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">m_2</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">product</span> <span class="o">=</span> <span class="n">multiply_inputs</span><span class="p">(</span><span class="n">m_1</span><span class="p">,</span> <span class="n">m_2</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">product</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="si">{}</span><span class="s2"> x </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m_1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">m_3</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">product</span> <span class="o">=</span> <span class="n">multiply_inputs</span><span class="p">(</span><span class="n">m_1</span><span class="p">,</span> <span class="n">m_3</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">product</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">m_1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ROW</span><span class="p">],</span> <span class="n">m_3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">COLUMN</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="si">{}</span><span class="s2"> x </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m_1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">m_4</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">product</span> <span class="o">=</span> <span class="n">multiply_inputs</span><span class="p">(</span><span class="n">m_1</span><span class="p">,</span> <span class="n">m_4</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">product</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">m_4</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">ROW</span><span class="p">],</span> <span class="n">m_1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">COLUMN</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
<pre class="example" id="org519aa7c">
(3, 2)
(2, 3) x (2, 3)
False

(2, 3) x (3, 2)
[[20 14]
 [56 41]]
(2, 2)

(2, 3) x (6, 2)
[[ 4  5  6]
 [14 19 24]
 [24 33 42]
 [34 47 60]
 [44 61 78]
 [54 75 96]]
(6, 3)
</pre></div>
</div>
<div class="outline-2" id="outline-container-orga4d6710">
<h2 id="orga4d6710">Find the mean</h2>
<div class="outline-text-2" id="text-orga4d6710">
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">find_mean</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Find the mean value</span>

<span class="sd">    Args:</span>
<span class="sd">     values: list of numeric values</span>
<span class="sd">    Returns:</span>
<span class="sd">     the average of the values in the given Python list</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">find_mean</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">outputs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">5</span>
</pre></div>
<pre class="example">
5.0
</pre></div>
</div>
<div class="outline-2" id="outline-container-orga5106de">
<h2 id="orga5106de">More Outputs</h2>
<div class="outline-text-2" id="text-orga5106de">
<div class="highlight">
<pre><span></span><span class="n">input_array</span><span class="p">,</span> <span class="n">inputs_minus_min</span><span class="p">,</span> <span class="n">inputs_div_max</span> <span class="o">=</span> <span class="n">prepare_inputs</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Input as Array: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_array</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Input minus min: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inputs_minus_min</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Input  Array: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inputs_div_max</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Multiply 1:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">multiply_inputs</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">]]))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Multiply 2:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">multiply_inputs</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]]))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Multiply 3:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">multiply_inputs</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]))))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Mean == </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">find_mean</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])))</span>
</pre></div>
<pre class="example" id="orgef5f69a">
Input as Array: [[-1  2  7]]
Input minus min: [[0 3 8]]
Input  Array: [[0.    0.375 1.   ]]
Multiply 1:
False
Multiply 2:
[[14]
 [32]]
Multiply 3:
[[ 9 12 15]]
Mean == 2.6666666666666665
</pre></div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html">How do you handle multiple inputs and outputs?</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-19T17:09:52-07:00" itemprop="datePublished" title="2018-10-19 17:09">2018-10-19 17:09</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#orgc13a399">Beginning</a>
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#org500fb18">Imports</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#orgb20f1f9">Set Up</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#orgefdf471">What is this?</a></li>
</ul>
</li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#org45e80bf">Middle</a>
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#org34d15a5">So how do you handle multiple inputs and outputs?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#orga3cabeb">Okay, but how do you build that network?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#org07c3a67">Dot Product</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#org7e2ca13">Vector-Matrix Multiplication</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#org9b9bdca">The Pandas Way</a></li>
</ul>
</li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/index.html#org2907144">Ending</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgc13a399">
<h2 id="orgc13a399">Beginning</h2>
<div class="outline-text-2" id="text-orgc13a399"></div>
<div class="outline-3" id="outline-container-org500fb18">
<h3 id="org500fb18">Imports</h3>
<div class="outline-text-3" id="text-org500fb18"></div>
<div class="outline-4" id="outline-container-org00096e4">
<h4 id="org00096e4">From Python</h4>
<div class="outline-text-4" id="text-org00096e4">
<div class="highlight">
<pre><span></span> from functools import partial
 from pathlib import Path
 from typing import List
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org72773a6">
<h4 id="org72773a6">From PyPi</h4>
<div class="outline-text-4" id="text-org72773a6">
<div class="highlight">
<pre><span></span>from graphviz import Digraph
from tabulate import tabulate

import holoviews
import numpy
import pandas
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgb20f1f9">
<h3 id="orgb20f1f9">Set Up</h3>
<div class="outline-text-3" id="text-orgb20f1f9"></div>
<div class="outline-4" id="outline-container-org88f5a87">
<h4 id="org88f5a87">Table Printer</h4>
<div class="outline-text-4" id="text-org88f5a87">
<div class="highlight">
<pre><span></span>TABLE = partial(tabulate, tablefmt="orgtbl", headers="keys")
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org0bf00fe">
<h4 id="org0bf00fe">Plotting</h4>
<div class="outline-text-4" id="text-org0bf00fe">
<div class="highlight">
<pre><span></span>SLUG = "how-do-you-handle-multiple-inputs-and-outputs"
ROOT = "../../../files/posts/grokking/03_forward_propagation/"
OUTPUT_PATH = Path(ROOT)/SLUG

Embed = partial(EmbedHoloviews, folder_path=OUTPUT_PATH)
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org7fa037e">
<h4 id="org7fa037e">Some Types</h4>
<div class="outline-text-4" id="text-org7fa037e">
<div class="highlight">
<pre><span></span>Vector = List[float]
Matrix = List[Vector]
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgefdf471">
<h3 id="orgefdf471">What is this?</h3>
<div class="outline-text-3" id="text-orgefdf471">
<p>This is a continuation of my notes on Chapter Three of "Grokking Deep Learning". In the previous post we looked at a simple neural network with one input and three outputs. Here we'll look at handling multiple inputs and outputs.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org45e80bf">
<h2 id="org45e80bf">Middle</h2>
<div class="outline-text-2" id="text-org45e80bf"></div>
<div class="outline-3" id="outline-container-org34d15a5">
<h3 id="org34d15a5">So how do you handle multiple inputs and outputs?</h3>
<div class="outline-text-3" id="text-org34d15a5">
<p>You create a network that has a node for each of the inputs and each input node has an output to each of the outputs. Here's the matrix representation of the network we're going to use.</p>
<div class="highlight">
<pre><span></span>data = pandas.DataFrame(
    dict(
        source=["Toes"] * 3 + ["Wins"] * 3 + ["Fans"] * 3,
        target=["Hurt", "Win", "Sad"] * 3,
        edge = [0.1, 0.1, 0, 0.1, 0.2, 1.3, -0.3, 0.0, 0.1]))
</pre></div>
<div class="highlight">
<pre><span></span>print(TABLE(data, showindex=False))
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">source</th>
<th class="org-left" scope="col">target</th>
<th class="org-right" scope="col">edge</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Toes</td>
<td class="org-left">Hurt</td>
<td class="org-right">0.1</td>
</tr>
<tr>
<td class="org-left">Toes</td>
<td class="org-left">Win</td>
<td class="org-right">0.1</td>
</tr>
<tr>
<td class="org-left">Toes</td>
<td class="org-left">Sad</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">Wins</td>
<td class="org-left">Hurt</td>
<td class="org-right">0.1</td>
</tr>
<tr>
<td class="org-left">Wins</td>
<td class="org-left">Win</td>
<td class="org-right">0.2</td>
</tr>
<tr>
<td class="org-left">Wins</td>
<td class="org-left">Sad</td>
<td class="org-right">1.3</td>
</tr>
<tr>
<td class="org-left">Fans</td>
<td class="org-left">Hurt</td>
<td class="org-right">-0.3</td>
</tr>
<tr>
<td class="org-left">Fans</td>
<td class="org-left">Win</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">Fans</td>
<td class="org-left">Sad</td>
<td class="org-right">0.1</td>
</tr>
</tbody>
</table>
<div class="figure" id="org4d6d27f">
<p><img alt="network.dot.png" src="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/network.dot.png"></p>
</div>
<p>Adding the weights to the diagram made it hard to read so here's a table version of the weights for the edges.</p>
<div class="highlight">
<pre><span></span>edges = data.pivot(index="target", columns="source", values="edge")
edges.columns.name = None
edges.index.name = None
print(TABLE(edges))
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">&nbsp;</th>
<th class="org-right" scope="col">Fans</th>
<th class="org-right" scope="col">Toes</th>
<th class="org-right" scope="col">Wins</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Hurt</td>
<td class="org-right">-0.3</td>
<td class="org-right">0.1</td>
<td class="org-right">0.1</td>
</tr>
<tr>
<td class="org-left">Sad</td>
<td class="org-right">0.1</td>
<td class="org-right">0</td>
<td class="org-right">1.3</td>
</tr>
<tr>
<td class="org-left">Win</td>
<td class="org-right">0</td>
<td class="org-right">0.1</td>
<td class="org-right">0.2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="outline-3" id="outline-container-orga3cabeb">
<h3 id="orga3cabeb">Okay, but how do you build that network?</h3>
<div class="outline-text-3" id="text-orga3cabeb">
<p>It's basically the same as with one output except you repeat for each node - for each node you calculate the weighted sum (dot product) of the inputs.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org07c3a67">
<h3 id="org07c3a67">Dot Product</h3>
<div class="outline-text-3" id="text-org07c3a67">
<div class="highlight">
<pre><span></span>def weighted_sum(inputs, weights):
    """Calculates the weighted sum of the inputs

    Args:

    """
    assert len(inputs) == len(weights)
    return sum((inputs[index] * weights[index] for index in range(len(inputs))))
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org7e2ca13">
<h3 id="org7e2ca13">Vector-Matrix Multiplication</h3>
<div class="outline-text-3" id="text-org7e2ca13">
<p>We'll take the inputs as a vector of length three since we have three features and the weights as a matrix of three rows and three columns and then multiply the inputs by each of the rows of weights using the dot product to get our three outputs.</p>
<ul class="org-ul">
<li>for each output take the dot product of the weights of its inputs and the input vector</li>
</ul>
<div class="highlight">
<pre><span></span>def vector_matrix_multiplication(vector: Vector, matrix: Matrix) -&gt; Vector:
    """takes the dot product of each row in the matrix and the vector

    Args:
     vector: the inputs to the network
     matrix: the weights

    Returns:
     outputs: the network's outputs
    """
    vector_length = len(vector)
    assert vector_length == len(matrix)
    return [weighted_sum(vector, matrix[output])
            for output in range(vector_length)]
</pre></div>
<p>To test it out I'll convert the weights to a matrix (list of lists).</p>
<div class="highlight">
<pre><span></span>weights = edges.values
</pre></div>
<p>Now we'll create a team that averages 8.5 toes per player, has won 65 percent of its games and has 1.2 million fans. Note that we have to match the column order of our edge data-frame.</p>
<div class="highlight">
<pre><span></span>TOES = 8.5
WINS = 0.65
FANS = 1.2
inputs = [FANS, TOES, WINS]
</pre></div>
<p>What does it predict? The output of our function will be a vector with the outputs in the order of the rows in our edge-matrix.</p>
<div class="highlight">
<pre><span></span>outputs = vector_matrix_multiplication(inputs, weights)
HURT = 0.555
SAD = 0.965
WIN = 0.98
expected_outputs = [HURT, SAD, WIN]
tolerance = 0.1**5
expected_actual = zip(expected_outputs, outputs)
names = "Hurt Sad Win".split()
print("| Node| Value|")
print("|-+-|")
for index, (expected, actual) in enumerate(expected_actual):
    print(f"|{names[index]}|{actual:.3f}")
    assert abs(actual - expected) &lt; tolerance,\
            "Expected: {} Actual: {} Difference: {}".format(expected,
                                                            actual,
                                                            expected-actual)
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Node</th>
<th class="org-right" scope="col">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Hurt</td>
<td class="org-right">0.555</td>
</tr>
<tr>
<td class="org-left">Sad</td>
<td class="org-right">0.965</td>
</tr>
<tr>
<td class="org-left">Win</td>
<td class="org-right">0.980</td>
</tr>
</tbody>
</table>
<p>So we are predicting that they have a 98% chance of winning and a 97% chance of being sad? I guess the fans have emotional problems outside of sports.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org9b9bdca">
<h3 id="org9b9bdca">The Pandas Way</h3>
<div class="outline-text-3" id="text-org9b9bdca">
<div class="highlight">
<pre><span></span>predictions = edges.dot(inputs)
print(TABLE(predictions.reset_index().rename(
    columns={"index": "Node", 0: "Value"}), showindex=False))
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Node</th>
<th class="org-right" scope="col">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Hurt</td>
<td class="org-right">0.555</td>
</tr>
<tr>
<td class="org-left">Sad</td>
<td class="org-right">0.965</td>
</tr>
<tr>
<td class="org-left">Win</td>
<td class="org-right">0.98</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org2907144">
<h2 id="org2907144">Ending</h2>
<div class="outline-text-2" id="text-org2907144">
<p>So, like we saw previously that finding the charge for a neuron is just vector math and making a network of neurons doesn't really change that, instead of doing it all as one matrix we could have taken each of our output nodes and treated them as a separate vector that we used to take the dot product:</p>
<div class="highlight">
<pre><span></span>print("|Node | Value|")
print("|-+-|")
for node in edges.index:
    print(f"|{node} |{edges.loc[node].dot(inputs): 0.3f}|")
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Node</th>
<th class="org-right" scope="col">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Hurt</td>
<td class="org-right">0.555</td>
</tr>
<tr>
<td class="org-left">Sad</td>
<td class="org-right">0.965</td>
</tr>
<tr>
<td class="org-left">Win</td>
<td class="org-right">0.980</td>
</tr>
</tbody>
</table>
<p>Which is like going back to our single neuron case for each output.</p>
<div class="figure" id="orgac4c6c0">
<p><img alt="hurt_neuron.dot.png" src="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/hurt_neuron.dot.png"></p>
</div>
<div class="figure" id="org50a5e03">
<p><img alt="Sad_neuron.dot.png" src="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/Sad_neuron.dot.png"></p>
</div>
<div class="figure" id="orga6aa628">
<p><img alt="Win_neuron.dot.png" src="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-inputs-and-outputs/Win_neuron.dot.png"></p>
</div>
<p>But by stacking them in a matrix it becomes easier to work with them as the network gets larger.</p>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html">How do you handle multiple outputs?</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-19T14:30:27-07:00" itemprop="datePublished" title="2018-10-19 14:30">2018-10-19 14:30</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#org650f9d5">Preliminaries</a>
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#org628d8af">Imports</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#orgf051fe1">Set Up</a></li>
</ul>
</li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#orgf56aa61">Beginning</a>
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#org30e108d">What is this?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#org1ef6d53">How do you handle one input and multiple outputs?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#orge123565">How do you implement this?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#org445b623">In Action</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#org830b5ed">How would you do this with numpy?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#org4dff21d">Pytorch?</a></li>
</ul>
</li>
<li><a href="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/index.html#orgb0dcf50">End</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org650f9d5">
<h2 id="org650f9d5">Preliminaries</h2>
<div class="outline-text-2" id="text-org650f9d5"></div>
<div class="outline-3" id="outline-container-org628d8af">
<h3 id="org628d8af">Imports</h3>
<div class="outline-text-3" id="text-org628d8af"></div>
<div class="outline-4" id="outline-container-orge920874">
<h4 id="orge920874">From Python</h4>
<div class="outline-text-4" id="text-orge920874">
<div class="highlight">
<pre><span></span> <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
 <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org16571da">
<h4 id="org16571da">From PyPi</h4>
<div class="outline-text-4" id="text-org16571da">
<div class="highlight">
<pre><span></span> <span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>
 <span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf051fe1">
<h3 id="orgf051fe1">Set Up</h3>
<div class="outline-text-3" id="text-orgf051fe1"></div>
<div class="outline-4" id="outline-container-org6c7341c">
<h4 id="org6c7341c">The Output Folder</h4>
<div class="outline-text-4" id="text-org6c7341c">
<p>This is where to put rendered images.</p>
<div class="highlight">
<pre><span></span><span class="n">PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../../files/posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orga356377">
<h4 id="orga356377">Data Types</h4>
<div class="outline-text-4" id="text-orga356377">
<div class="highlight">
<pre><span></span><span class="n">Vector</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf56aa61">
<h2 id="orgf56aa61">Beginning</h2>
<div class="outline-text-2" id="text-orgf56aa61"></div>
<div class="outline-3" id="outline-container-org30e108d">
<h3 id="org30e108d">What is this?</h3>
<div class="outline-text-3" id="text-org30e108d">
<p>This is a continuation of my notes on Chapter Three of "Grokking Deep Learning". In the previous post we looked at a simple neural network with three inputs and one output. Here we'll look at handling multiple outputs.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org1ef6d53">
<h3 id="org1ef6d53">How do you handle one input and multiple outputs?</h3>
<div class="outline-text-3" id="text-org1ef6d53">
<p>Suppose instead of using multiple inputs to predict an outcome (like winning) you instead had a single input and multiple outputs (like what percentage feels sad, or indifferent based on whether you won or lost as well as whether you will win). You could create a network to represent it something like this.</p>
<div class="highlight">
<pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Feelings Model"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"Won/Lost"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="s2">"Hurt"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="s2">"Win"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="s2">"Sad"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".3"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".2"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".9"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"feelings_model.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org1527a32">
<p><img alt="feelings_model.dot.png" src="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/feelings_model.dot.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orge123565">
<h3 id="orge123565">How do you implement this?</h3>
<div class="outline-text-3" id="text-orge123565">
<p>In this case the outputs are simply the (single) input times the weight of the output, so while the single output was the dot-product of the inputs and the weights, this, the multiple output case, is an elementwise multiplication of the input and the weights.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">elementwise_multiplication</span><span class="p">(</span><span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""multiplies the value against each of the weights</span>

<span class="sd">    Returns:</span>
<span class="sd">     output: scalar times each of the weights as a list</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">scalar</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org445b623">
<h3 id="org445b623">In Action</h3>
<div class="outline-text-3" id="text-org445b623">
<p>Here's some sample values that we can use to see what this network gives us. Our input is the fraction of the games won up to a given week and our outputs are the fraction of players that are hurt, the probability that they won or lost, and whether the players are happy or sad.</p>
<div class="highlight">
<pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="s2">"Hurt Win Sad"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="n">fraction_of_wins</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
</pre></div>
<p>These are the probabilities of a fan feeling a certain way the first week.</p>
<div class="highlight">
<pre><span></span><span class="n">wins</span> <span class="o">=</span> <span class="n">fraction_of_wins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.195</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.585</span><span class="p">]</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">elementwise_multiplication</span><span class="p">(</span><span class="n">wins</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">5</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">actual</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">expected</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">-</span> <span class="n">item</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Feelings Model"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Wins=</span><span class="si">{</span><span class="n">wins</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Hurt=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Win=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Sad=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".3"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".2"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".9"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"feelings_model_with_output.dot"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"[[file:feelings_model_with_output.dot.png]]"</span><span class="p">)</span>
</pre></div>
<div class="figure" id="org74e9c79">
<p><img alt="feelings_model_with_output.dot.png" src="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/feelings_model_with_output.dot.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org830b5ed">
<h3 id="org830b5ed">How would you do this with numpy?</h3>
<div class="outline-text-3" id="text-org830b5ed">
<p>Since this is just element-wise multiplication, all you have to do is create an array and then multiply it by the scalar input.</p>
<div class="highlight">
<pre><span></span><span class="n">vector_weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">vector_weights</span> <span class="o">*</span> <span class="n">wins</span>
<span class="n">vector_expected</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Feelings Model"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Wins=</span><span class="si">{</span><span class="n">wins</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Hurt=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Win=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Sad=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".3"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".2"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".9"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"numpy_feelings_model_with_output.dot"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"[[file:numpy_feelings_model_with_output.dot.png]]"</span><span class="p">)</span>
</pre></div>
<div class="figure" id="orgbea9070">
<p><img alt="numpy_feelings_model_with_output.dot.png" src="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/numpy_feelings_model_with_output.dot.png"></p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org4dff21d">
<h3 id="org4dff21d">Pytorch?</h3>
<div class="outline-text-3" id="text-org4dff21d">
<p>Like numpy, pytorch uses the multiplication operator for element-wise multiplication.</p>
<div class="highlight">
<pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span>
<span class="n">weights_vector</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights_vector</span> <span class="o">*</span> <span class="n">wins</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Feelings Model"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Wins=</span><span class="si">{</span><span class="n">wins</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Hurt=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Win=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Sad=</span><span class="si">{</span><span class="n">actual</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".3"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".2"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">".9"</span> <span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"pytorch_feelings_model_with_output.dot"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"[[file:pytorch_feelings_model_with_output.dot.png]]"</span><span class="p">)</span>
</pre></div>
<div class="figure" id="orgb75d495">
<p><img alt="pytorch_feelings_model_with_output.dot.png" src="posts/grokking/03_forward_propagation/how-do-you-handle-multiple-outputs/pytorch_feelings_model_with_output.dot.png"></p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb0dcf50">
<h2 id="orgb0dcf50">End</h2>
<div class="outline-text-2" id="text-orgb0dcf50">
<p>So that's it for handling multiple outputs from a node to multiple nodes. As with the many inputs to one node what you're really doing is vector math, when reducing from many to one you use the dot product and when going from one to many you use scalar multiplication.</p>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html">How Do Neurons Work?</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-17T15:04:33-07:00" itemprop="datePublished" title="2018-10-17 15:04">2018-10-17 15:04</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org5803c59">Beginning</a>
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org763572d">Imports</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#orga30829f">What is this about?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org7a87273">Set Up</a></li>
</ul>
</li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org401ece3">Middle</a>
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#orga5c5203">What is the simplest neural network we can create to make this prediction?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org6da0d72">What does <i>knowledge</i> and <i>information</i> mean in our neural network?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#orgb091d82">What kind of memory does a neuron have?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#orgaa83f8c">So weights are memory, but what is it memorizing?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org4b3cad0">So, how do you handle multiple inputs?</a></li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org01cbe7f">How would you do this with numpy?</a></li>
</ul>
</li>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org3ca9948">End</a>
<ul>
<li><a href="posts/grokking/03_forward_propagation/how-do-neural-networks-work/index.html#org906a748">Sources</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org5803c59">
<h2 id="org5803c59">Beginning</h2>
<div class="outline-text-2" id="text-org5803c59"></div>
<div class="outline-3" id="outline-container-org763572d">
<h3 id="org763572d">Imports</h3>
<div class="outline-text-3" id="text-org763572d">
<p>Some if this is needed to draw the network so I'm putting all the imports first.</p>
</div>
<div class="outline-4" id="outline-container-orgfeec198">
<h4 id="orgfeec198">From Python</h4>
<div class="outline-text-4" id="text-orgfeec198">
<div class="highlight">
<pre><span></span> <span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
 <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
 <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgb8207ca">
<h4 id="orgb8207ca">From PyPi</h4>
<div class="outline-text-4" id="text-orgb8207ca">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>
<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">hvplot.pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">torch</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgdaa69ec">
<h4 id="orgdaa69ec">Others</h4>
<div class="outline-text-4" id="text-orgdaa69ec">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graeae</span> <span class="kn">import</span> <span class="n">EmbedHoloviews</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orga30829f">
<h3 id="orga30829f">What is this about?</h3>
<div class="outline-text-3" id="text-orga30829f">
<p>These are notes on Chapter Three of "Grokking Deep Learning". It is an explanation of how neural networks perform the first step of training the model - making predictions - illustrated with a single neuron. Predicting might seem like a step for after you finish training the model, but in order to correct the model you have to first make predictions to see how well it is doing. We'll look at a model that predicts whether a team will win a game based on a single feature (the average number of toes on the team).</p>
<p>Heres' the network.</p>
<div class="highlight">
<pre><span></span><span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"how-do-neural-networks-work/"</span>
<span class="n">PATH</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../../files/posts/grokking/03_forward_propagation/"</span><span class="p">)</span><span class="o">/</span><span class="n">SLUG</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Toes Model"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span>
                <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"Toes"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="s2">"Win"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"w=0.1"</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"toes_model_1.dot"</span><span class="p">)</span>
<span class="n">graph</span>
</pre></div>
<div class="figure" id="org7f27bd0">
<p><img alt="toes_model_1.dot.png" src="posts/grokking/03_forward_propagation/how-do-neural-networks-work/toes_model_1.dot.png"></p>
</div>
<p>Although we're calling it a network we're really creating only the first building block for a single neuron. A neuron works by doing three basic things:</p>
<ol class="org-ol">
<li>It receives signals from other neurons (over <i>dendrites</i>, the inputs to the neuron)</li>
<li>It aggregates the signals within the cell-body (<i>soma</i>) of the neuron</li>
<li>If the cell voltage crosses a threshold then it fires a signal out across its <i>axon</i></li>
</ol>
<p>We can kind of say there's an implied axon to our network, it just isn't shown, and we can read the <i>Toes</i> node as either another neuron and the edge between it and the <i>Win</i> node is a <i>synapse</i> (Greek for <i>conjunction</i>) which contains an axon coming out of <i>Toes</i> that joins the dendrite going into <i>Win</i>), giving us a network of two nodes, but what we are missing is the test to see if the cell's charge exceeds a threshold. That will come later.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org7a87273">
<h3 id="org7a87273">Set Up</h3>
<div class="outline-text-3" id="text-org7a87273"></div>
<div class="outline-4" id="outline-container-org543f9a2">
<h4 id="org543f9a2">Plotting</h4>
<div class="outline-text-4" id="text-org543f9a2">
<div class="highlight">
<pre><span></span><span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
    <span class="n">EmbedHoloviews</span><span class="p">,</span>
    <span class="n">folder_path</span><span class="o">=</span><span class="n">PATH</span><span class="p">)</span>

<span class="n">holoviews</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgcfb81b4">
<h4 id="orgcfb81b4">Types</h4>
<div class="outline-text-4" id="text-orgcfb81b4">
<p>This is for type-hinting.</p>
<div class="highlight">
<pre><span></span><span class="n">Numbers</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org401ece3">
<h2 id="org401ece3">Middle</h2>
<div class="outline-text-2" id="text-org401ece3"></div>
<div class="outline-3" id="outline-container-orga5c5203">
<h3 id="orga5c5203">What is the simplest neural network we can create to make this prediction?</h3>
<div class="outline-text-3" id="text-orga5c5203"></div>
<div class="outline-4" id="outline-container-orgf890454">
<h4 id="orgf890454">Our Network</h4>
<div class="outline-text-4" id="text-orgf890454">
<div class="figure" id="org6c9dc31">
<p><img alt="toes_model_1.dot.png" src="posts/grokking/03_forward_propagation/how-do-neural-networks-work/toes_model_1.dot.png"></p>
</div>
<p>Our network represents two neurons with a synapse between them. The dendrite leading into the <i>Win</i> neuron has a certain weight representing how much of the input signal (average number of toes) can get across it to the <i>Win</i> neuron - the higher the weight, the more signal it contributes to our <i>Win</i> neuron deciding whether to fire or not (once we add a threshold). In this case we have an arbitrary weight of 0.1. The input to the <i>Win</i> neuron is just the weight of the dendrite times the output of the <i>Toes</i> neuron.</p>
<p>In the book <i>Grokking Deep Learning</i> Andrew Trask uses the analogy of the weights being like the knob on a machine that turns the volume up and down (I don't think he says volume, but it's the same idea). This is something that I seem to recall seeing in books describing the coefficients for linear regression - every variable you add gives you another knob to tune, but since the more common analogy is to think of modeling artificial neurons in the brain, it might be better to think of the weights as the thickness of the dendrite.</p>
<div class="highlight">
<pre><span></span> <span class="k">def</span> <span class="nf">one_neuron</span><span class="p">(</span><span class="n">toes</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">     </span><span class="sd">"""This is a model to predict whether a team will win</span>

<span class="sd">     Args:</span>
<span class="sd">      toes: Average number of toes on the team</span>
<span class="sd">      weight: how much to weight to give to the toes</span>

<span class="sd">     Returns:</span>
<span class="sd">      prediction: our guess as to the probability that they will win</span>
<span class="sd">     """</span>
     <span class="k">return</span> <span class="n">toes</span> <span class="o">*</span> <span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org4148097">
<h4 id="org4148097">Some Predictions</h4>
<div class="outline-text-4" id="text-org4148097">
<p>We can test out what our model thinks with some test values.</p>
<div class="highlight">
<pre><span></span> <span class="n">average_toes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">8.5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
 <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">one_neuron</span><span class="p">(</span><span class="n">toe</span><span class="p">)</span> <span class="k">for</span> <span class="n">toe</span> <span class="ow">in</span> <span class="n">average_toes</span><span class="p">]</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">"| Toes | Probability of Winning (%)|"</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">"|-+-|"</span><span class="p">)</span>
 <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">toes</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">average_toes</span><span class="p">):</span>
     <span class="n">prediction</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"| </span><span class="si">{</span><span class="n">toes</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">prediction</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> % |"</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Toes</th>
<th class="org-left" scope="col">Probability of Winning (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">8.5</td>
<td class="org-left">85 %</td>
</tr>
<tr>
<td class="org-right">9</td>
<td class="org-left">90 %</td>
</tr>
<tr>
<td class="org-right">9.5</td>
<td class="org-left">95 %</td>
</tr>
<tr>
<td class="org-right">10</td>
<td class="org-left">100 %</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span> <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Average Toes"</span><span class="p">:</span> <span class="n">average_toes</span><span class="p">,</span>
                          <span class="s2">"Probability of Winning"</span><span class="p">:</span> <span class="n">predictions</span><span class="p">})</span>
 <span class="n">plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Average Toes"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Probability of Winning"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
     <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Toe Model"</span><span class="p">)</span>
 <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"toes_only_predictions"</span><span class="p">)()</span>
</pre></div>
<object data="posts/grokking/03_forward_propagation/how-do-neural-networks-work/toes_only_predictions.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>As you can see, it's just a straight line. If we think in terms of the familiar \(y=mx + b\), our model is the equivalent of:</p>
<p>\[ probability = 0.1 \times toes \]</p>
<p>Where \(b=0\). So every toe contributes 10% to our prediction.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org6da0d72">
<h3 id="org6da0d72">What does <i>knowledge</i> and <i>information</i> mean in our neural network?</h3>
<div class="outline-text-3" id="text-org6da0d72">
<p>The neural network stores its <i>knowledge</i> as weights and when given <i>information</i> (input) it converts them to a prediction (output).</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgb091d82">
<h3 id="orgb091d82">What kind of memory does a neuron have?</h3>
<div class="outline-text-3" id="text-orgb091d82">
<p>A neuron stores what its learned (long-term memory) as the weight on the edge(s). The neuron as we've implemented it doesn't have any short-term memory, it can only consider one input at a time and "forgets" the previous input that it got. To have short-term memory you need to employ a different method that uses multiple inputs at the same time.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgaa83f8c">
<h3 id="orgaa83f8c">So weights are memory, but what is it memorizing?</h3>
<div class="outline-text-3" id="text-orgaa83f8c">
<p>Since the neuron represents one feature (average toes) the weight is how important this feature is to the outcome (winning). If you have multiple features, the weights turn up or down the volume for each of the features (thus the knob analogy).</p>
</div>
</div>
<div class="outline-3" id="outline-container-org4b3cad0">
<h3 id="org4b3cad0">So, how do you handle multiple inputs?</h3>
<div class="outline-text-3" id="text-org4b3cad0">
<p>If you have multiple inputs then your prediction is the sum of the individual inputs times their weights.</p>
<div class="highlight">
<pre><span></span> <span class="n">graph</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"Three Nodes"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">,</span>
                 <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">"rankdir"</span><span class="p">:</span> <span class="s2">"LR"</span><span class="p">,</span> <span class="s2">"dpi"</span><span class="p">:</span> <span class="s2">"200"</span><span class="p">})</span>
 <span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"Toes"</span><span class="p">)</span>
 <span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="s2">"Wins"</span><span class="p">)</span>
 <span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="s2">"Fans"</span><span class="p">)</span>
 <span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">"D"</span><span class="p">,</span> <span class="s2">"Prediction"</span><span class="p">)</span>
 <span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"0.1"</span><span class="p">)</span>
 <span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"0.2"</span><span class="p">)</span>
 <span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">"C"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"0.0"</span><span class="p">)</span>
 <span class="n">graph</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">PATH</span><span class="o">/</span><span class="s2">"three_nodes.dot"</span><span class="p">)</span>
</pre></div>
<div class="figure" id="orgc3c734c">
<p><img alt="three_nodes.dot.png" src="posts/grokking/03_forward_propagation/how-do-neural-networks-work/three_nodes.dot.png"></p>
</div>
<p>Here we've added two more input neurons - <i>Wins</i> is the fraction of games played that the team won and <i>Fans</i> is the number of fans the team has (in millions).</p>
</div>
<div class="outline-4" id="outline-container-orgec1efc0">
<h4 id="orgec1efc0">Weighted Sum</h4>
<div class="outline-text-4" id="text-orgec1efc0">
<p>Since we have three nodes we need to return the sum of the weights and inputs. If we think of the weights and inputs as vectorns then this is <a href="https://en.wikipedia.org/wiki/Dot_product">their dot-product</a>.</p>
<div class="highlight">
<pre><span></span> <span class="k">def</span> <span class="nf">weighted_sum</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">Numbers</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">Numbers</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">     </span><span class="sd">"""calculates the sum of the products</span>

<span class="sd">     Args:</span>
<span class="sd">      inputs: list of input data</span>
<span class="sd">      weights: list of weights for the inputs</span>

<span class="sd">     Returns:</span>
<span class="sd">      sum: the sum of the product of the weights and inputs</span>
<span class="sd">     """</span>
     <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
     <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">inputs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org73ebdac">
<h4 id="org73ebdac">The Node</h4>
<div class="outline-text-4" id="text-org73ebdac">
<p>Right now this next function is just an alias for the <code>weighted_sum</code> but eventually we'll be doing more with it.</p>
<div class="highlight">
<pre><span></span> <span class="k">def</span> <span class="nf">network</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">Numbers</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span><span class="n">Numbers</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">     </span><span class="sd">"""Makes a prediction based on the inputs and weights"""</span>
     <span class="k">return</span> <span class="n">weighted_sum</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org18cc7f3">
<h4 id="org18cc7f3">Some Inputs</h4>
<div class="outline-text-4" id="text-org18cc7f3">
<p>We have some data collected about our team over four games.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Variable</th>
<th class="org-left" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>toes</code></td>
<td class="org-left">average number of toes the members have at game-time</td>
</tr>
<tr>
<td class="org-left"><code>record</code></td>
<td class="org-left">fraction of games won</td>
</tr>
<tr>
<td class="org-left"><code>fans</code></td>
<td class="org-left">Millions of fans that watched</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span> <span class="n">toes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">8.5</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="mf">9.9</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">]</span>
 <span class="n">record</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
 <span class="n">fans</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
</pre></div>
<p>Each entry in the vectors is the value that was true just before each game. This makes the first <code>record</code> entry sort of non-sensical, but it's just an illustration.</p>
<div class="highlight">
<pre><span></span> <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
</pre></div>
<p>The weights correspond to <i>(toes, record, fans)</i> for each game so we weight the win-loss record the most and fans not at all. Our for game <i>i</i> (so 0 if it's the first game), our prediction will be calculated as:</p>
\begin{align} prediction_i &amp;= toes_i \times weights_0 + record_i \times weights_1 + fans_i \times weights_2\\ &amp;= (0.1) toes_i + (0.2) record_i + (0) fans_i\\ \end{align}
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"|Game|Prediction|"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"|-+-|"</span><span class="p">)</span>

<span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">network</span><span class="p">([</span><span class="n">toes</span><span class="p">[</span><span class="n">game</span><span class="p">],</span> <span class="n">record</span><span class="p">[</span><span class="n">game</span><span class="p">],</span> <span class="n">fans</span><span class="p">[</span><span class="n">game</span><span class="p">]],</span> <span class="n">weights</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">game</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toes</span><span class="p">))]</span>
<span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.98</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">5</span>

<span class="k">for</span> <span class="n">game</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"|</span><span class="si">{</span><span class="n">game</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">prediction</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Game</th>
<th class="org-right" scope="col">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.98</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">1.11</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">1.15</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">1.08</td>
</tr>
</tbody>
</table>
<p>With the exception of game one we're predicting that the combination of toes and previous wins make the win pretty much inevitable. We should also note that the highestt prediction went to the third game which was the game with the highest number of average toes. Even though we weighted the win-loss record higher, the values being passed in are much greater for the toes than for the win-loss record.</p>
<div class="highlight">
<pre><span></span> <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"toes"</span><span class="p">:</span> <span class="n">toes</span><span class="p">,</span> <span class="s2">"record"</span><span class="p">:</span> <span class="n">record</span><span class="p">,</span>
                          <span class="s2">"prediction"</span><span class="p">:</span> <span class="n">predictions</span><span class="p">})</span>
 <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">"toes"</span><span class="p">)</span>
 <span class="n">prediction_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"toes"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"prediction"</span><span class="p">)</span>
 <span class="n">other</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"toes"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"record"</span><span class="p">)</span>
 <span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">prediction_plot</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
     <span class="n">title</span><span class="o">=</span><span class="s2">"Toes vs Record & Prediction"</span><span class="p">,</span>
     <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
     <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
 <span class="p">)</span>

 <span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"toes_vs_record"</span><span class="p">)()</span>
</pre></div>
<object data="posts/grokking/03_forward_propagation/how-do-neural-networks-work/toes_vs_record.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Looking at the plot you can see that the probability keeps climbing with the number of toes and the peak record (9 toes, 90% wins) is canceled out by the fact that it occurs with a team with fewer toes than the peak of 9.9 toes.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org01cbe7f">
<h3 id="org01cbe7f">How would you do this with numpy?</h3>
<div class="outline-text-3" id="text-org01cbe7f">
<p>Although we used for-loops to calculate the predictions, we can view each of the inputs as a vector and the weights as a vector and then the prediction becomes the dot product of the inputs and the weights, so we can use numpy's <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html">dot</a> method to calculate it for us.</p>
<div class="highlight">
<pre><span></span> <span class="nb">print</span><span class="p">(</span><span class="s2">"|Game|Prediction|"</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">"|-+-|"</span><span class="p">)</span>

 <span class="n">network</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">toes</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">fans</span><span class="p">])</span>
 <span class="n">predictions</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
 <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.98</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="o">**</span><span class="mi">5</span>

 <span class="k">for</span> <span class="n">game</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions</span><span class="p">):</span>
     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"|</span><span class="si">{</span><span class="n">game</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">prediction</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">|"</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Game</th>
<th class="org-right" scope="col">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.98</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">1.11</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">1.15</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">1.08</td>
</tr>
</tbody>
</table>
</div>
<div class="outline-4" id="outline-container-orgc0ded09">
<h4 id="orgc0ded09">What about pytorch</h4>
<div class="outline-text-4" id="text-orgc0ded09">
<p>Pytorch can act like numpy working on the GPU, making the calculations faster, but the syntax is a little different (and it uses <a href="https://pytorch.org/docs/stable/torch.html#torch.matmul">matmul</a> instead of dot).</p>
<div class="highlight">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"|Game|Prediction|"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"|-+-|"</span><span class="p">)</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">toes</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">fans</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">weights_vector</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">weights_vector</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">game</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"|</span><span class="si">{</span><span class="n">game</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">prediction</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">|"</span><span class="p">)</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-right" scope="col">Game</th>
<th class="org-right" scope="col">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.98</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">1.11</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">1.15</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">1.08</td>
</tr>
</tbody>
</table>
<p><b>Note:</b> In this simple case the pytorch version can be much slower than the numpy version - sometimes "optimization" isn't really optimal.</p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org3ca9948">
<h2 id="org3ca9948">End</h2>
<div class="outline-text-2" id="text-org3ca9948">
<p>The main takeaway from this is that a neuron is takes the weighted sum of its input in order to build its internal value (its charge) and the weighted sum is in turn the dot product of the weight vector and the input vector.</p>
</div>
<div class="outline-3" id="outline-container-org906a748">
<h3 id="org906a748">Sources</h3>
<div class="outline-text-3" id="text-org906a748">
<ul class="org-ul">
<li>[GDL] Trask AW. Grokking Deep Learning. Shelter Island: Manning; 2019. 309 p.</li>
<li>[DLI] Krohn J. Deep Learning Illustrated: a visual, interactive guide to artificial intelligence. Boston, MA: Addison-Wesley; 2019.</li>
<li><a href="https://github.com/iamtrask/Grokking-Deep-Learning/blob/master/Chapter3%20-%20%20Forward%20Propagation%20-%20Intro%20to%20Neural%20Prediction.ipynb">iamtrask</a>: Andrew Trask's jupyter notebook (on github) for this chapter</li>
</ul>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="posts/grokking/how-do-machines-learn/index.html">How Do Machines Learn?</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="posts/grokking/how-do-machines-learn/index.html" rel="bookmark"><time class="published dt-published" datetime="2018-10-17T12:13:54-07:00" itemprop="datePublished" title="2018-10-17 12:13">2018-10-17 12:13</time></a></p>
</div>
</header>
<div class="e-content entry-content">
<div class="outline-2" id="outline-container-org6d7c8d8">
<h2 id="org6d7c8d8">What is this?</h2>
<div class="outline-text-2" id="text-org6d7c8d8">
<p>I'm reading <a href="https://www.manning.com/books/grokking-deep-learning">Grokking Deep Learning</a> and am going to put my notes here. This is from Chapter 2 - <i>How Do Machines Learn</i>?</p>
</div>
</div>
<div class="outline-2" id="outline-container-org5ebaf62">
<h2 id="org5ebaf62">What is Deep Learning?</h2>
<div class="outline-text-2" id="text-org5ebaf62">
<p>Deep learning is a sub-field of <i>Machine Learning</i> that primarily use <i>Artificial Neural Networks</i>.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org054fce4">
<h2 id="org054fce4">What is Machine Learning?</h2>
<div class="outline-text-2" id="text-org054fce4">
<p>Machine Learning is a sub-field of computer science where computers learn to do things that they weren't explicitly programmed to do. Their main goal is to map a data set to some other useful data set.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org64fc924">
<h2 id="org64fc924">What is Supervised Learning?</h2>
<div class="outline-text-2" id="text-org64fc924">
<p>Supervised Learning methods transforms one dataset into another. They take what we already know and try to come up with what we want to know.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org5b1a13a">
<h2 id="org5b1a13a">What is Unsupervised Learning?</h2>
<div class="outline-text-2" id="text-org5b1a13a">
<p>Unsupervised Learring methods group your data. They take your data and try to come up with labels for clusters within the data.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgdcb9b69">
<h2 id="orgdcb9b69">What are Parametric and Non-Parametric Learning?</h2>
<div class="outline-text-2" id="text-orgdcb9b69"></div>
<div class="outline-3" id="outline-container-org2e1964c">
<h3 id="org2e1964c">What is Parametric Learning?</h3>
<div class="outline-text-3" id="text-org2e1964c">
<ul class="org-ul">
<li>Parametric: trial-and-error (has a fixed number of parameters)</li>
<li>Non-Parametric: counting and probability (has an infinite number of parameters)</li>
</ul>
<p>The classifications <i>Supervised</i> and <i>Unsupervised</i> refers to the pattern that is being learned, while <i>Parametric</i> vs <i>Non-Parametric</i> is about the way what's learned is stored.</p>
</div>
<div class="outline-4" id="outline-container-org8670c81">
<h4 id="org8670c81">What is Supervised Parametric Learning?</h4>
<div class="outline-text-4" id="text-org8670c81">
<p>Trial and error learning that tunes your model's knobs.</p>
<ul class="org-ul">
<li>Step One: Make a prediction using your data</li>
<li>Step Two: Compare your predictions to the real answer</li>
<li>Step Three: Change your model based on how you did - make it more or less sensitive to each of the parameters</li>
</ul>
</div>
</div>
<div class="outline-4" id="outline-container-org1d23894">
<h4 id="org1d23894">What is Unsupervised Parametric Learning?</h4>
<div class="outline-text-4" id="text-org1d23894">
<p>It's parametric, so it has knobs to twiddle when finding groups, but the knobs are used to tune the input data's likelihood of being in a group.</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orgd88c169">
<h3 id="orgd88c169">What is Non-Parametric Learnining?</h3>
<div class="outline-text-3" id="text-orgd88c169">
<p>These are counting-based methods - the number of parameters depends on the data. If you have a set of labels relating to an outcome, each label might be a parameter and your model would count how many times each label lead to the outcome you're watching.</p>
</div>
</div>
</div>
</div>
</article>
</div>
<ul class="pager postindexpager clearfix">
<li class="previous"><a href="index-2.html" rel="prev">Newer posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Scribbles by <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>
<div id="license" xmlns:cc="http://creativecommons.org/ns#">This work is licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" rel="license noopener noreferrer" style="display:inline-block;" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a></div>
</footer>
</div>
</div>
<script src="assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
